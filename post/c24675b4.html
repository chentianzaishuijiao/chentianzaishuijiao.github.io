<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>MySQL | 陈天在睡觉</title><meta name="author" content="陈天在睡觉"><meta name="copyright" content="陈天在睡觉"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="ffffff"><meta name="description" content="MySQL一、初识MySQLMySQL是一个开放源代码的数据库管理系统（DBMS），是由MySQL 公司开发、发布并支持的。MySQL是一个跨平台的开源关系型数据库管理系统，广泛地应用在Internet上的中小型网站开发中。 1、数据库基础数据库由一批数据构成有序的集合，这些数据被存放在结构化的数据表里。数据表之间相互关联，反映了客观事物间的本质联系。数据库系统提供对数据的安全控制和完整性控制。">
<meta property="og:type" content="article">
<meta property="og:title" content="MySQL">
<meta property="og:url" content="http://example.com/post/c24675b4.html">
<meta property="og:site_name" content="陈天在睡觉">
<meta property="og:description" content="MySQL一、初识MySQLMySQL是一个开放源代码的数据库管理系统（DBMS），是由MySQL 公司开发、发布并支持的。MySQL是一个跨平台的开源关系型数据库管理系统，广泛地应用在Internet上的中小型网站开发中。 1、数据库基础数据库由一批数据构成有序的集合，这些数据被存放在结构化的数据表里。数据表之间相互关联，反映了客观事物间的本质联系。数据库系统提供对数据的安全控制和完整性控制。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/img/%E5%8D%9A%E5%AE%A23.jpg">
<meta property="article:published_time" content="2023-01-14T16:00:00.000Z">
<meta property="article:modified_time" content="2023-01-28T06:56:21.155Z">
<meta property="article:author" content="陈天在睡觉">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/img/%E5%8D%9A%E5%AE%A23.jpg"><link rel="shortcut icon" href="/img/%E6%9F%BF%E5%AD%90.png"><link rel="canonical" href="http://example.com/post/c24675b4"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":230},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: true,
    post: true
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":50,"languages":{"author":"作者: 陈天在睡觉","link":"链接: ","source":"来源: 陈天在睡觉","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"top-right"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'MySQL',
  isPost: true,
  isHome: false,
  isHighlightShrink: true,
  isToc: true,
  postUpdate: '2023-01-28 14:56:21'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          const now = new Date()
          const hour = now.getHours()
          const isNight = hour <= 6 || hour >= 18
          if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
          else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="/css/font.css"><meta name="generator" content="Hexo 6.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/%E5%A4%B4%E5%83%8F.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">7</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">5</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/img/%E5%8D%9A%E5%AE%A23.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">陈天在睡觉</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">MySQL</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-01-14T16:00:00.000Z" title="发表于 2023-01-15 00:00:00">2023-01-15</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-01-28T06:56:21.155Z" title="更新于 2023-01-28 14:56:21">2023-01-28</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/MySQL/">MySQL</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">24.5k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>85分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="MySQL"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="MySQL"><a href="#MySQL" class="headerlink" title="MySQL"></a>MySQL</h1><h2 id="一、初识MySQL"><a href="#一、初识MySQL" class="headerlink" title="一、初识MySQL"></a>一、初识MySQL</h2><p>MySQL是一个开放源代码的数据库管理系统（DBMS），是由MySQL 公司开发、发布并支持的。<br>MySQL是一个跨平台的开源关系型数据库管理系统，广泛地应用在Internet上的中小型网站开发中。</p>
<h3 id="1、数据库基础"><a href="#1、数据库基础" class="headerlink" title="1、数据库基础"></a>1、数据库基础</h3><p>数据库由一批数据构成有序的集合，这些数据被存放在结构化的数据表里。数据表之间相互关联，反映了客观事物间的本质联系。数据库系统提供对数据的安全控制和完整性控制。</p>
<h3 id="1-1-什么是数据库"><a href="#1-1-什么是数据库" class="headerlink" title="1.1 什么是数据库"></a>1.1 什么是数据库</h3><p>数据库的概念诞生于60年前，随着信息技术和市场的快速发展，数据库技术层出不穷，随着应用的拓展和深入，数据库的数量和规模越来越大，其诞生和发展给计算机信息管理带来了一场巨大的革命。数据库的发展大致划分为如下几个阶段：人工管理阶段、文件系统阶段、数据库系统阶段、高级数据库阶段。其种类大概有3种：层次式数据库、网络式数据库和关系式数据库。不同种类的数据库按不同的数据结构来联系和组织。对于数据库的概念，没有一个完全固定的定义，随着数据库历史的发展，定义的内容也有很大的差异，其中一种比较普遍的观点认为，数据库（DataBase，DB）是一个长期存储在计算机内的、有组织的、有共享的、统一管理的数据集合。它是一个按数据结构来存储和管理数据的计算机软件系统。数据库包含两层含义：保管数据的“仓库”，以及数据管理的方法和技术。<br>数据库的特点是：实现数据共享，减少数据冗余；采用特定的数据类型；具有较高的数据独立性；具有统一的数据控制功能。</p>
<h3 id="1-2-表"><a href="#1-2-表" class="headerlink" title="1.2 表"></a>1.2 表</h3><p>在关系数据库中，数据库表是一系列二维数组的集合，用来存储数据和操作数据的逻辑结构。它由纵向的列和横向的行组成。行被称为记录。是组织数据的单位。列被称为字段，每一列表示记录的一个属性，有相应的描述信息，如数据类型、数据宽度等。<br>比如我们有个员工表，用于保存员工的基本信息</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/post/c24675b4/Users\84750\AppData\Roaming\Typora\typora-user-images\image-20220412090813659.png" alt="image-20220412090813659"></p>
<h3 id="1-3-数据类型"><a href="#1-3-数据类型" class="headerlink" title="1.3 数据类型"></a>1.3 数据类型</h3><p>数据类型决定了数据在计算机中的存储格式，代表不同的信息类型。常用的数据类型有整数数据类型、浮点数数据类型、精确小数类型、二进制数 据类型、日期&#x2F;时间数据类型、字符串数据类型。表中的每一个字段就是某种指定数据类型。</p>
<table>
<thead>
<tr>
<th><strong>类型</strong></th>
<th><strong>大小</strong></th>
<th><strong>范围（有符号</strong></th>
<th><strong>范围（无符号</strong></th>
<th><strong>用途</strong></th>
</tr>
</thead>
<tbody><tr>
<td>TINYINT</td>
<td>1 Bytes</td>
<td>(-128，127)</td>
<td>(0，255)</td>
<td>小整数值</td>
</tr>
<tr>
<td>SMALLINT</td>
<td>2 Bytes</td>
<td>(-32  768，32 767)</td>
<td>(0，65  535)</td>
<td>大整数值</td>
</tr>
<tr>
<td>MEDIUMINT</td>
<td>3 Bytes</td>
<td>(-8  388 608，8 388 607)</td>
<td>(0，16  777 215)</td>
<td>大整数值</td>
</tr>
<tr>
<td>INT或  INTEGER</td>
<td>4 Bytes</td>
<td>(-2  147 483 648，  2  147 483 647)</td>
<td>(0，4  294 967  295)</td>
<td>大整数值</td>
</tr>
<tr>
<td>BIGINT</td>
<td>8 Bytes</td>
<td>(-9,223,372,036,854,775,808，  9  223 372 036 854 775 807)</td>
<td>(0，  18 446 744  073  709  551 615)</td>
<td>极大整数值</td>
</tr>
<tr>
<td>FLOAT</td>
<td>4 Bytes</td>
<td></td>
<td></td>
<td>单精度浮点数值</td>
</tr>
<tr>
<td>DOUBLE</td>
<td>8Bytes</td>
<td></td>
<td></td>
<td>双精度浮点数值</td>
</tr>
<tr>
<td>DECIMAL</td>
<td></td>
<td>对DECIMAL(M,D)  ，如果M&gt;D，为M+2否则为D+2</td>
<td></td>
<td>小数值</td>
</tr>
</tbody></table>
<p><strong>日期和时间类型</strong>	 表示时间值的日期和时间类型为DATETIME、DATE、TIMESTAMP、TIME和YEAR。</p>
<table>
<thead>
<tr>
<th><strong>类型</strong></th>
<th><strong>大小</strong></th>
<th><strong>范围</strong></th>
<th><strong>格式</strong></th>
<th><strong>用途</strong></th>
</tr>
</thead>
<tbody><tr>
<td>DATE</td>
<td>3</td>
<td>1000-01-01&#x2F;9999-12-31</td>
<td>YYYY-MM-DD</td>
<td>日期值</td>
</tr>
<tr>
<td>TIME</td>
<td>3</td>
<td>‘-838:59:59’&#x2F;‘838:59:59’</td>
<td>HH:MM:SS</td>
<td>时间值或持续时间</td>
</tr>
<tr>
<td>YEAR</td>
<td>1</td>
<td>1901&#x2F;2155</td>
<td>YYYY</td>
<td>年份值</td>
</tr>
<tr>
<td>DATETIME</td>
<td>8</td>
<td>1000-01-01  00:00:00&#x2F;9999-  12-31  23:59:59</td>
<td>YYYY-MM-DD  HH:MM:SS</td>
<td>混合日期和时间值</td>
</tr>
<tr>
<td>TIMESTAMP</td>
<td>4</td>
<td>1970-01-01  00:00:00&#x2F;2038</td>
<td>YYYYMMDD  HHMMSS</td>
<td>混合日期和时间值，时间戳</td>
</tr>
</tbody></table>
<p><strong>字符串类型</strong></p>
<p>字符串类型指CHAR、VARCHAR、BINARY、VARBINARY、BLOB、TEXT。该节描述了这些类型如何工作以及如何在查询中使用这些类型。</p>
<table>
<thead>
<tr>
<th><strong>类型</strong></th>
<th><strong>大小</strong></th>
<th><strong>用途</strong></th>
</tr>
</thead>
<tbody><tr>
<td>CHAR</td>
<td>0-255  bytes</td>
<td>定长字符串</td>
</tr>
<tr>
<td>VARCHAR</td>
<td>0-65535  bytes</td>
<td>变长字符串</td>
</tr>
<tr>
<td>BLOB</td>
<td>0-65  535 bytes</td>
<td>二进制形式的长文本数据</td>
</tr>
<tr>
<td>TEXT</td>
<td>0-65  535 bytes</td>
<td>长文本数据</td>
</tr>
</tbody></table>
<p><strong>主键</strong>	<br>主键（Primary Key）又称主码，用于唯一地标识表中的每一条记录。可以定义表中的一列或多列为主键，主键列上既不能有两行相同的值，也不能为空值。假如，定义authors表，该表给每一个作者分配一个“作者编号”，该编号作为数据表的主键，如果出现相同的值，将提示错误，系统不能确定查询的究竟是哪一条记录；如果把作者的“姓名”作为主键，则不能出现重复的名字，这与现实中的情况不符，因此“姓名”字段不适合作为主键。</p>
<h3 id="1-4-数据库技术构成"><a href="#1-4-数据库技术构成" class="headerlink" title="1.4 数据库技术构成"></a>1.4 数据库技术构成</h3><p>数据库系统由硬件部分和软件部分共同构成。硬件主要用于存储数据库中的数据，包括计算机、存储设备等。软件部分主要包括DBMS、支持DBMS运行的操作系统，以及支持多种语言进行应用开发的访问技术等。<br>数据库系统	 数据库系统有3个主要的组成部分<br>●	数据库：用于存储数据的地方。<br>●	数据库管理系统：用于管理数据库的软件。<br>●	数据库应用程序：为了提高数据库系统的处理能力所使用的管理数据库的软件补充。<br>数据库系统（Database System）提供了一个存储空间，用以存储各种数据，可以将数据库视为一个存储数据的容器。一个数据库可能包含许多文件，一个数据库系统中通常包含许多数据库。<br>数据库管理系统（DataBase Management System，DBMS）是用户创 建、管理和维护数据库时所使用的软件，位于用户与操作系统之间，对数据库进行统一管理。DBMS能定义数据存储结构，提供数据的操作机制，维护数据库的安全性、完整性和可靠性。 数据库应用程序（DataBase Application）虽然已经有了DBMS，但是在很多情况下，DBMS无法满足对数据管理的要求。数据库应用程序的使用可以满足对数据管理的更高要求，还可以使数据管理过程更加直观和友好。数据库应用程序负责与DBMS进行通信，访问和管理DBMS中存储的数据，允许用户插入、修改、删除DB中的数据。  </p>
<h4 id="1-4-1-SQL语言"><a href="#1-4-1-SQL语言" class="headerlink" title="1.4.1 SQL语言"></a>1.4.1 SQL语言</h4><p>对数据库进行查询和修改操作的语言叫作SQL。SQL的含义是结构化查询语言（Structured Query<br>Language）。<br>SQL有许多不同的类型，有3个主要的标准：ANSI（美国国家标准机构）SQL；对ANSI SQL修改后在 1992年采纳的标准，称为SQL-92或SQL2； 近的SQL-99标准，从SQL2 扩充而来并增加了对象关系特征和许多其他新功能。各大数据库厂商提供不同版本的SQL。这些版本的SQL不但能包括原始的ANSI标准，而且在很大程度上支 持SQL-92标准。</p>
<p>SQL语言包含以下4部分。<br>（1）	数据定义语言（Data Definition Language   DDL）：DROP、CREATE、ALTER等语句。<br>（2）	数据操作语言（Data Manipulation Language  DML）：INSERT（插入）、UPDATE（修改）、DELETE（删除）语句。<br>（3）	数据查询语言（Data Query Language   DQL）：SELECT语句。<br>（4）	数据控制语言（Data Control Language DCL）：GRANT、REVOKE、COMMIT、 ROLLBACK等语句。</p>
<h4 id="1-4-2-数据库接口"><a href="#1-4-2-数据库接口" class="headerlink" title="1.4.2 数据库接口"></a>1.4.2 数据库接口</h4><p>不同的程序设计语言会有各自不同的数据库访问接口，程序语言通过这 些接口执行SQL语句，进行数据库管理。主要的数据库访问接口有ODBC、 JDBC、ADO.NET和PDO【PHP】。 </p>
<p>JDBC（Java Data Base Connectivity，Java数据库连接）用于Java应用程 序连接数据库的标准方法，是一种用于执行SQL语句的Java API，可以为多 种关系数据库提供统一访问，由一组用Java语言编写的类和接口组成。 </p>
<h2 id="二、MySQL"><a href="#二、MySQL" class="headerlink" title="二、MySQL"></a>二、MySQL</h2><p>MySQL是一个小型关系数据库管理系统。与其他大型数据库管理系统 （例如Oracle、DB2、SQL Server 等）相比，MySQL规模小、功能有限，但是它体积小、速度快、成本低，并且提供的功能对稍微复杂的应用来说已经够用，这些特性使得MySQL成为世界上 受欢迎的开放源代码数据库</p>
<h3 id="2-1-客户端-x2F-服务器软件"><a href="#2-1-客户端-x2F-服务器软件" class="headerlink" title="2.1 客户端&#x2F;服务器软件"></a>2.1 客户端&#x2F;服务器软件</h3><p>主从式架构（Client-Server Model）或客户端&#x2F;服务器（Client&#x2F;Server）结 构（简称C&#x2F;S结构），是一种网络架构，通常在该网络架构下的软件可分为客户端（Client）和服务器（Server）。服务器是整个应用系统资源的存储与管理中心，多个客户端则各自处理相应的功能，共同实现完整的应用。在客户端&#x2F;服务器结构中，客户端用户的请求被传送到数据库服务器，数据库服务器进行处理后，将结果返回给用户，从而减少了网络数据传输量。用户使用应用程序时，首先启动客户端通过有关命令告知服务器进行连接以完成各种操作，而服务器则按照此请示提供相应的服务。每一个客户端软件的实例都可以向一个服务器或应用程序服务器发出请求。这种系统的特点就是，客户端和服务器程序不在同一台计算机上运行，这些客户端和服务器程序通常归属不同的计算机。主从式架构通过不同的途径应用于很多不同类型的应用程序，比如现在人们 熟悉的在因特网上使用的网页。例如，当顾客想要在当当网站上买书 的时候，电脑和网页浏览器就被当作一个客户端，同时组成当当网的电脑、数据库和应用程序就被当作服务器。当顾客的网页浏览器向当当网请求搜寻 数据库相关的图书时，当当网服务器从当当网的数据库中找<br>出所有该类型的 图书信息，结合成一个网页，再发送回顾客的浏览器。服务器一般使用高性 能的计算机，并配合使用不同类型的数据库，比如Oracle、Sybase或者是MySQL等；客户端需要安装专门的软件，比如专门开发的客户端工具浏览。</p>
<p><strong>MySQL的不同版本</strong> </p>
<p>MySQL Community Server（社区版服务器）该版本完全免费，但是官方不提供技术支持。<br>  MySQL Enterprise Server（企业版服务器）能够以很高的性价比为企业提供数据仓库应用，支持ACID 事物处理，提供完整的提交、回滚、崩溃恢复和行级锁定功能。但是该版本需付费使用，官方提供电话技术支持。 MySQL Cluster主要用于架设集群服务器，需要在社区版或企业版基础上使用。<br>MySQL 8.0是 新开发的稳定（GA）发布系列，是将执行新功能的系列，目前已经可以正常使用。<br>MySQL 8.0是比较稳定（GA）发布系列。只针对漏洞修复重新发 布，没有增加会影响稳定性的新功能。<br>MySQL 5.7是前一稳定（产品质量）发布系列。只针对严重漏洞 修复和安全修复重新发布，没有增加会影响该系列的重要功能。 </p>
<p><strong>MySQL的优势：</strong><br>（1）	速度：运行速度快。<br>（2）	价格：MySQL对多数个人来说是免费的。（3）容易使用：与其他大型数据库的设置和管理相比，其复杂程度较低，易于学习<br>（4）	可移植性：能够工作在众多不同的系统平台上，例如Windows、 Linux、UNIX、Mac OS等。<br>（5）	丰富的接口：提供了用于C、C++、Eiffel、Java、Perl、PHP、 Python、Ruby和Tcl等语言的<br>API。<br>（6）	支持查询语言：MySQL可以利用标准SQL语法和支持ODBC的应用程序。<br>（7）	安全性和连接性：十分灵活和安全的权限和密码系统，允许基于主机的验证。连接到服务器时，所有的密码传输均采用加密形式，从而保证 了密码安全。由于MySQL是网络化的，因此可以在因特网上的任何地方访 问，提高数据共享的效率。</p>
<p>MySQL 8.0的新特性和MySQL 5.7相比，MySQL 8.0的新特性主要包括以下几个方面。<br><strong>1.数据字典</strong><br>MySQL 8.0包含一个事务数据字典，用于存储有关数据库对象的信息。在MySQL 8.0之前的版本中，字典数据存储在元数据文件和非事务表中。<br><strong>2.原子数据定义语句</strong><br>MySQL 8.0支持原子数据定义语言（DDL）语句。此功能称为原子 DDL。原子DDL语句将与DDL操作关联的数据字典更新，存储引擎操作和 二进制日志写入组合到单个原子事务中。即使服务器在操作期间暂停，也会 提交事务，并将适用的更改保留到数据字典、存储引擎和二进制日志，或者<br>回滚事务。通过在MySQL 8.0中引入MySQL数据字典，可以实现原子 DDL。在早期的MySQL版本中，元数据存储在元数据文件、非事务性表和 存储引擎特定的字典中，需要中间提交。MySQL数据字典提供的集中式事 务元数据存储消除了这一障碍，使得将DDL语句操作重组为原子事务成为可能。</p>
<p><strong>3.安全和账户管理</strong><br>MySQL 8.0通过以下功能增强数据库的安全性，并在账户管理中实现更<br>高的DBA灵活性。 MySQL数据库的授权表统一为InnoDB（事务性）表。每个语句都是事务性的，并且对所有创建的用户都是成功或者回滚，发生任何错误都无效。如果成功，就将语句写入二进制日志；如果失败则不写入，发生回滚并且不<br>进行任何更改。 MySQL 8.0开始支持角色，角色可以看成是一些权限的集合，为用户赋予统一的角色，权限的修改直接通过角色来进行，无须为每个用户单独授<br>权。管理员可以创建和删除角色。 MySQL 8.0开始维护有关密码历史的信息，从而限制了以前密码的重 用。管理员可以在全局以及每个账户的基础上建立密码重用策略，从而在密<br>码更改时限制使用以前使用过的密码。 MySQL 8.0允许账户具有双密码，从而在多服务器系统中无缝地执行分 阶段密码更改，无须停机。 </p>
<p><strong>4.资源管理</strong><br>MySQL现在支持资源组的创建和管理，并允许将服务器内运行的线程 分配给特定的资源组。资源组属性可以控制其资源，以启用或限制资源组中 线程的资源消耗。数据库管理员可以根据不同的工作负载修改这些属性。</p>
<p><strong>5.InnoDB增强功能</strong></p>
<p>MySQL 8.0增强了InnoDB的功能，主要表现如下：<br>（1）	MySQL 8.0将自增主键的计数器持久化到重做日志中。每次计数<br>器发生改变，都会将其写入重做日志中。如果数据库重启，InnoDB会根据重做日志中的信息来初始化计数器的内存值。为了尽量减小对系统性能的影响，计数器写入重做日志时，并不会马上刷新数据库系统。<br>（2）	如果索引损坏，InnoDB将索引损坏标志写入重做日志，从而使得<br>损坏标志安全。InnoDB还将内存中损坏标志数据写入每个检查点上的引擎专用系统表。在恢复期间，InnoDB从两个位置读取损坏标志并在将内存表和索引对象标记为损坏之前合并结果。<br>（3）	新的动态变量innodb_deadlock_detect可用于禁用死锁检测。在高<br>并发系统上，当许多线程等待同一个锁时，死锁检测会导致速度减慢，此时禁用死锁检测可能更有效。<br>  <strong>6.字符集支持</strong><br>默认字符集已经更改latin1为utf8mb4。该utf8mb4字符集有几个新的排 序规则，其中包括 utf8mb4_ja_0900_as_cs。<br>  <strong>7.增加JSON功能</strong><br>MySQL增强JSON功能主要表现在以下几个方面：<br>（1）	添加了-&gt;&gt;运算符，相当于调用JSON_UNQUOTE()的结果。<br>（2）	添加了两个JSON聚合函数JSON_ARRAYAGG()和 39JSON_OBJECTAGG()。JSON_ARRAYAGG()将列或表达式作为其参数，并 将结果聚合为单个JSON数组。JSON_OBJECTAGG()取两个列或表达式，将 其解释为键和值，并将结果作为单个JSON对象返回。<br>（3）	添加了JSON实用程序功能JSON_PRETTY()，JSON以易于阅读的 格式输出现有值；每个JSON对象成员或数组值都打印在一个单独的行上子对象或数组相对于其父对象是2个空格。<br>（4）	添加的JSON_MERGE_PATCH()可以合并符合RFC 7396标准的 JSON。在两个JSON对象上使用时，可以将它们合并为单个JSON对象。<br> <strong>8.数据类型支持</strong><br>MySQL 8.0支持将表达式用作数据类型的默认值，包括BLOB、TEXT、 GEOMETRY和JSON数据类型，在以前的版本中是根本不会被分配默认值 的。</p>
<p><strong>9.查询的优化</strong><br>MySQL 8.0在查询方面的优化表现如下：<br>（1）	MySQL<br>8.0开始支持不可见索引。优化器根本不使用不可见索 引，但会以其他方式正常维护。默认情况下，索引是可见的。通过不可见索 引，数据库管理员可以检测索引对查询性能的影响，而不会进行破坏性的更 改。<br>（2）	MySQL8.0开始支持降序索引。DESC在索引定义中不再被忽略， 而且会降序存储索引字段。</p>
<h3 id="2-2MySQL的安装与配置"><a href="#2-2MySQL的安装与配置" class="headerlink" title="2.2MySQL的安装与配置"></a>2.2MySQL的安装与配置</h3><p>查看是否链接成功</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/post/c24675b4/Users\84750\AppData\Roaming\Typora\typora-user-images\image-20220412091517752.png" alt="image-20220412091517752"></p>
<h2 id="三、数据库基本操作"><a href="#三、数据库基本操作" class="headerlink" title="三、数据库基本操作"></a>三、数据库基本操作</h2><h3 id="3-1-创建数据库"><a href="#3-1-创建数据库" class="headerlink" title="3.1 创建数据库"></a>3.1 创建数据库</h3><p>MySQL安装完成之后，将会在其data目录下自动创建几个必需的数据 库，可以使用</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> DATABASES;</span><br></pre></td></tr></table></figure>

<p>语句来查看当前所有存在的数据库， 输入语句如下。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/post/c24675b4/Users\84750\AppData\Roaming\Typora\typora-user-images\image-20220412091543395.png" alt="image-20220412091543395"> </p>
<p>其中有六个库是mysql必须的，其余是自己创建的库。如何自己创建库呢？可以使用sql语句创建数据库;</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> DATABASE database_name;</span><br></pre></td></tr></table></figure>

<p>可以使用命令查看数据库的定义</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> <span class="keyword">CREATE</span> DATABASE mybatis;</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/post/c24675b4/Users\84750\AppData\Roaming\Typora\typora-user-images\image-20220412091909792.png" alt="image-20220412091909792"></p>
<h3 id="3-2-删除数据库"><a href="#3-2-删除数据库" class="headerlink" title="3.2 删除数据库"></a>3.2 删除数据库</h3><p>删除数据库是将已经存在的数据库从磁盘空间上清除，清除之后，数据 库中的所有数据也将一同被删除。删除数据库语句和创建数据库的命令相 似，MySQL中删除数据库的基本语法格式为： </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> DATABASE database_name</span><br></pre></td></tr></table></figure>

<p>其中，“database_name”为要删除的数据库的名称。若指定的数据库不存 在，则删除出错</p>
<h3 id="3-3-InnoDB表"><a href="#3-3-InnoDB表" class="headerlink" title="3.3 InnoDB表"></a>3.3 InnoDB表</h3><p>从MySQL 8.0开始，系统表全部换成事务型的InnoDB表，默认的 MySQL实例将不包含任何MyISAM 表，除非手动创建MyISAM表。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> ENGINE <span class="keyword">FROM</span> information_schema.`TABLES`;</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/post/c24675b4/Users\84750\AppData\Roaming\Typora\typora-user-images\image-20220412092010416.png" alt="image-20220412092010416"></p>
<h3 id="面试题："><a href="#面试题：" class="headerlink" title="面试题："></a>面试题：</h3><p>InnoDB和MyISAM的区别</p>
<p><strong>区别：</strong></p>
<ol>
<li>InnoDB 支持事务，MyISAM 不支持事务。这是 MySQL 将默认存储引擎从 MyISAM 变成 InnoDB 的重要原因之一；</li>
<li>InnoDB 支持外键，而 MyISAM 不支持。对一个包含外键的 InnoDB 表转为 MYISAM 会失败；  </li>
<li>InnoDB 是聚集索引，MyISAM 是非聚集索引。聚簇索引的文件存放在主键索引的叶子节点上，因此 InnoDB 必须要有主键，通过主键索引效率很高。但是辅助索引需要两次查询，先查询到主键，然后再通过主键查询到数据。因此，主键不应该过大，因为主键太大，其他索引也都会很大。而<br>MyISAM 是非聚集索引，数据文件是分离的，索引保存的是数据文件的指针。主键索引和辅助索引是独立的。 </li>
<li>InnoDB 不保存表的具体行数，执行 select count(*) from table 时需要全表扫描。而MyISAM 用一个变量保存了整个表的行数，执行上述语句时只需要读出该变量即可，速度很快；    </li>
<li>InnoDB 小的锁粒度是行锁，MyISAM 小的锁粒度是表锁。一个更新语句会锁住整张表，导致其他查询和更新都会被阻塞，因此并发访问受限。这也是 MySQL 将默认存储引擎从 MyISAM 变成<br>InnoDB 的重要原因之一；</li>
</ol>
<p><strong>如何选择：</strong></p>
<ol>
<li>是否要支持事务，如果要请选择 InnoDB，如果不需要可以考虑 MyISAM；</li>
<li>如果表中绝大多数都只是读查询，可以考虑 MyISAM，如果既有读写也挺频繁，请使用InnoDB。</li>
<li>系统奔溃后，MyISAM恢复起来更困难，能否接受，不能接受就选 InnoDB；</li>
<li>MySQL5.5版本开始Innodb已经成为Mysql的默认引擎(之前是MyISAM)，说明其优势是有目共睹的。如果你不知道用什么存储引擎，那就用InnoDB，至少不会差。</li>
<li>删除数据库时需要注意什么？<br>使用DROP DATABASE命令时要非常谨慎，在执行该命令时，MySQL 不会给出任何提醒确认信<br>息。用DROP DATABASE声明删除数据库后，数 据库中存储的所有数据表和数据也将一同被删除，而且不能恢复。</li>
</ol>
<h3 id="练习："><a href="#练习：" class="headerlink" title="练习："></a><strong>练习：</strong></h3><p>​    1.查看当前系统中的数据库<br>​    2.创建数据库mydb,使用语句查看数据库定义新新<br>​    3.删除数据库mydb</p>
<h2 id="四、数据表的基本操作"><a href="#四、数据表的基本操作" class="headerlink" title="四、数据表的基本操作"></a>四、数据表的基本操作</h2><h3 id="4-1-创建数据表"><a href="#4-1-创建数据表" class="headerlink" title="4.1 创建数据表"></a>4.1 创建数据表</h3><p>在创建完数据库之后，接下来的工作就是创建数据表。所谓创建数据 表，指的是在已经创建好的数据库中建立新表。创建数据表的过程是规定数 据列的属性的过程，同时也是实施数据完整性（包括实体完整性、引用完整 性和域完整性等）约束的过程。<br>数据表属于数据库，在创建数据表之前，应该使用语句“USE &lt;数据库 名&gt;”指定操作是在哪个数据库中进行，如果没有选择数据库，就会抛出“No database selected”的错误。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/post/c24675b4/Users\84750\AppData\Roaming\Typora\typora-user-images\image-20220412092420575.png" alt="image-20220412092420575"></p>
<p>创建数据表的语句为CREATE TABLE，语法规则如下：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> TAB_NAME(</span><br><span class="line">	字段<span class="number">1</span> 类型 约束 默认值,</span><br><span class="line">	字段<span class="number">2</span> 类型 约束 默认值,</span><br><span class="line">	字段n 类型 约束 默认值</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p>使用CREATE TABLE创建表时，必须指定以下信息：<br>（1）	要创建的表的名称，不区分大小写，不能使用SQL语言中的关键 字，如DROP、ALTER、INSERT 等。<br>（2）	数据表中每一列（字段）的名称和数据类型，如果创建多列，就要用逗号隔开。<br>案例：创建员工表：employee</p>
<table>
<thead>
<tr>
<th><strong>字段名</strong></th>
<th><strong>数据类型</strong></th>
<th><strong>备注</strong></th>
</tr>
</thead>
<tbody><tr>
<td>emp_id</td>
<td>int</td>
<td>员工编号</td>
</tr>
<tr>
<td>emp_name</td>
<td>varchar(50)</td>
<td>员工名字</td>
</tr>
<tr>
<td>emp_sex</td>
<td>char(2)</td>
<td>员工性别</td>
</tr>
<tr>
<td>emp_salary</td>
<td>float</td>
<td>员工工资</td>
</tr>
<tr>
<td>emp_phone</td>
<td>varchar(50)</td>
<td>员工电话</td>
</tr>
<tr>
<td>emp_birth</td>
<td>date</td>
<td>员工生日</td>
</tr>
<tr>
<td>dept_id</td>
<td>int</td>
<td>所在部门</td>
</tr>
</tbody></table>
<p>创建表的sql语句如下：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> employee(</span><br><span class="line">	emp_id <span class="type">INT</span>,</span><br><span class="line">	emp_name <span class="type">VARCHAR</span>(<span class="number">50</span>),</span><br><span class="line">	emp_sex <span class="type">CHAR</span>(<span class="number">2</span>),</span><br><span class="line">	emp_salary <span class="type">FLOAT</span>,</span><br><span class="line">	emp_phone <span class="type">VARCHAR</span>(<span class="number">50</span>),</span><br><span class="line">	emp_birth <span class="type">DATE</span>,</span><br><span class="line">	dept_id <span class="type">INT</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>



<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/post/c24675b4/Users\84750\AppData\Roaming\Typora\typora-user-images\image-20220412092623208.png" alt="image-20220412092623208"></p>
<p>此时可以通过以下命令查看该库下的表</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> TABLES;</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/post/c24675b4/Users\84750\AppData\Roaming\Typora\typora-user-images\image-20220412092654756.png" alt="image-20220412092654756"></p>
<p>通过上图可以看到表中还有一些默认值，主键，非空等。这些都是属于表的约束。</p>
<h3 id="4-2-表约束"><a href="#4-2-表约束" class="headerlink" title="4.2 表约束"></a>4.2 表约束</h3><p><strong>1.数据完整性</strong></p>
<p>数据的完整性是指数据的可靠性和准确性<br>1.实体完整性：实体的完整性强制表的标识符列或主键的完整性(通过索引,唯一约束,主键约束或标识列属性).<br>2.域完整性：限制类型(数据类型),格式(通过检查约束和规则),可能值范围(通过外键约束,检查约束,默认值定义,非空约束和规则).<br>3.引用完整性：在删除和输入记录时,引用完整性保持表之间已定义的关系.引用完整性确保键值在所有表中一致.这样的一致辞性要求不能引用不存在的值.如果一个键值更改了,那么在整个数据库中,对该键值的引用要进行一致的更改.<br>4.自定义完整性：用户自己定义的业务规则.<br>四种完整性约束：</p>
<p>实体完整性：<em><strong>唯一约束、主键约束、标识列</strong></em> </p>
<p>域完完整性：<em><strong>限制数据类型、外键约束、默认值、非空约束</strong></em> </p>
<p>引用完整性：<em><strong>外键</strong></em><br>自定义完整性：过程，触发器等</p>
<p><strong>2.约束</strong><br>约束是在表上强制执行的一些数据校验规则，被插入、修改或删除的数据必须符合在相关字段上设置的这些约束条件。<br>五类完整性约束：<br>NOT NULL       非空<br>UNIQUE         唯一<br>PRIMARY KEY    主键 FOREIGN KEY    外键</p>
<p>AUTO_INCREMENT自增</p>
<p>CHECKED        检查(mysql不支持的)</p>
<h4 id="4-2-1-主键约束"><a href="#4-2-1-主键约束" class="headerlink" title="4.2.1 主键约束"></a>4.2.1 主键约束</h4><p>主键，又称主码，是表中一列或多列的组合。主键约束（Primary Key Constraint）要求主键列的数据唯一，并且不允许为空。主键能够唯一地标 识表中的一条记录，可以结合外键来定义不同数据表之间的关系，并且可以 加快数据库查询的速度。主键和记录之间的关系如同身份证和人之间的关 系，它们之间是一一对应的。主键分为两种类型：单字段主键和多字段联合主键。</p>
<h5 id="1-单子段主键"><a href="#1-单子段主键" class="headerlink" title="1.单子段主键"></a>1.单子段主键</h5><p>主键由一个字段组成，SQL语句格式分为以下两种情况。<br>1)定义列的同时指定主键，语法如下</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">字段名 字段类型 <span class="keyword">primary</span> key</span><br></pre></td></tr></table></figure>

<p>如：创建部门表 dept，表结构如下</p>
<table>
<thead>
<tr>
<th><strong>字段名</strong></th>
<th><strong>数据类型</strong></th>
<th><strong>备注</strong></th>
</tr>
</thead>
<tbody><tr>
<td>deptid</td>
<td>int</td>
<td>部门编号 主键</td>
</tr>
<tr>
<td>dept_name</td>
<td>varchar(50)</td>
<td>部门名称</td>
</tr>
<tr>
<td>dept_desc</td>
<td>varchar(200)</td>
<td>部门描述</td>
</tr>
<tr>
<td>dept_num</td>
<td>int</td>
<td>部门人数</td>
</tr>
</tbody></table>
<p>sql语句如下：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> dept(</span><br><span class="line">	deptid <span class="type">INT</span> <span class="keyword">PRIMARY</span> KEY,</span><br><span class="line">	dept_name <span class="type">VARCHAR</span>(<span class="number">50</span>),</span><br><span class="line">	dept_desc <span class="type">VARCHAR</span>(<span class="number">200</span>),</span><br><span class="line">	dept_num <span class="type">INT</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/post/c24675b4/Users\84750\AppData\Roaming\Typora\typora-user-images\image-20220412093550305.png" alt="image-20220412093550305"></p>
<p>通过上图，我们还看到有个自增，自增是什么？<br>在数据库应用中，经常希望在每次插入新记录时，系统自动生成字段的 主键值。可以通过为表主键添加 AUTO_INCREMENT关键字来实现。默认 的，在MySQL中AUTO_INCREMENT的初始值是1，每新增一条<br>记录，字段 值自动加1。一个表只能有一个字段使用AUTO_INCREMENT约束，且该字 段必须为主键的一部分。AUTO_INCREMENT约束的字段可以是任何整数 类型（TINYINT、SMALLIN、INT、BIGINT 等）。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> dept(</span><br><span class="line">	deptid <span class="type">INT</span> <span class="keyword">PRIMARY</span> KEY AUTO_INCREMENT,</span><br><span class="line">	dept_name <span class="type">VARCHAR</span>(<span class="number">50</span>),</span><br><span class="line">	dept_desc <span class="type">VARCHAR</span>(<span class="number">200</span>),</span><br><span class="line">	dept_num <span class="type">INT</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/post/c24675b4/Users\84750\AppData\Roaming\Typora\typora-user-images\image-20220412093641022.png" alt="image-20220412093641022"></p>
<p>2)定义表之后指定主键 </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> 表名 <span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span>主键名 <span class="keyword">PRIMARY</span> KEY(字段);</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> employee <span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> pk_empid <span class="keyword">PRIMARY</span> KEY(emp_id);</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/post/c24675b4/Users\84750\AppData\Roaming\Typora\typora-user-images\image-20220412093722664.png" alt="image-20220412093722664"></p>
<h5 id="2-联合主键"><a href="#2-联合主键" class="headerlink" title="2.联合主键"></a>2.联合主键</h5><p>主键由多个字段联合组成，语法规则如下： </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">primary</span> key(字段<span class="number">1</span>,字段<span class="number">2</span>,...字段n)</span><br></pre></td></tr></table></figure>

<p>表关系详细讲解。<br>主键选取原则：</p>
<ol>
<li>   主键应当是对用户没有意义的。如果用户看到了一个表示多对多关系的连接表中的数据，并抱怨它没有什么用处，那就证明它的主键设计地很好。</li>
<li>   主键应该是单列的，以便提高连接和筛选操作的效率。</li>
<li>   永远也不要更新主键。实际上，因为主键除了惟一地标识一行之外，再没有其他的用途了，所以也就没有理由去对它更新。如果主键需要更新，则说明主键应对用户无意义的原则被违反了。</li>
<li>   主键不应包含动态变化的数据，如时间戳、创建时间列、修改时间列等。</li>
<li>   主键应当有计算机自动生成<br> 我们在建立数据库的时候，需要为每张表指定一个主键，所谓主键就是能够唯一标识表中某一行的属性或属性组，一个表只能有一个主键，但可以有多个候选索引。因为主键可以唯一标识某一行记录，所以可以确保执行数据更新、删除的时候不会出现张冠李戴的错误。当然，其它字段可以辅助我们在执行这些操作时消除共享冲突，不过就不在这里讨论了。主键除了上述作用外，常常与外键构成参照完整性约束，防止出现数据不一致。所以数据库在设计时，主键起到了很重要的作用。</li>
</ol>
<h4 id="4-2-2-非空约束"><a href="#4-2-2-非空约束" class="headerlink" title="4.2.2 非空约束"></a>4.2.2 非空约束</h4><p>非空约束（Not Null Constraint）指字段的值不能为空。对于使用了非空 约束的字段，如果用户在添加数据时没有指定值，数据库系统会报错。 </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">字段名 数据类型 <span class="keyword">not</span> <span class="keyword">null</span></span><br></pre></td></tr></table></figure>

<h4 id="4-2-3-唯一约束"><a href="#4-2-3-唯一约束" class="headerlink" title="4.2.3 唯一约束"></a>4.2.3 唯一约束</h4><p>唯一性约束（Unique Constraint）要求该列唯一，允许为空，但只能出 现一个空值。唯一约束可以确保一列或者几列不出现重复值。 唯一性约束的语法规则如下</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">字段名 数据类型 <span class="keyword">UNIQUE</span></span><br></pre></td></tr></table></figure>

<p>如果定义完表后也可以给某个字段添加唯一约束，语法如下：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> 表名 <span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> 约束名 <span class="keyword">UNIQUE</span> (约束字段);</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> employee <span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> uk_phone <span class="keyword">UNIQUE</span> (emp_phone);</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/post/c24675b4/Users\84750\AppData\Roaming\Typora\typora-user-images\image-20220412093937799.png" alt="image-20220412093937799"></p>
<p>删除唯一索引的语法：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> 表名 <span class="keyword">DROP</span> INDEX 约束名;</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> employee <span class="keyword">DROP</span> INDEX uk_phone;</span><br></pre></td></tr></table></figure>

<h4 id="4-2-4-默认值约束"><a href="#4-2-4-默认值约束" class="headerlink" title="4.2.4 默认值约束"></a>4.2.4 默认值约束</h4><p>默认约束（Default Constraint）指定某列的默认值。如男性同学较多， 性别就可以默认为‘男’。如果插入一条新的记录时没有为这个字段赋值，那么系统会自动为这个字段赋值为‘男’。 默认约束的语法规则如下：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">字段名 字段类型 <span class="keyword">default</span> 默认值</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> employee(</span><br><span class="line">	emp_id <span class="type">INT</span>,</span><br><span class="line">	emp_name <span class="type">VARCHAR</span>(<span class="number">50</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> ,</span><br><span class="line">	emp_sex <span class="type">CHAR</span>(<span class="number">2</span>) <span class="keyword">DEFAULT</span> <span class="string">&#x27;男&#x27;</span>,</span><br><span class="line">	emp_salary <span class="type">FLOAT</span>,</span><br><span class="line">	emp_phone <span class="type">VARCHAR</span>(<span class="number">50</span>) <span class="keyword">UNIQUE</span> ,</span><br><span class="line">	emp_birth <span class="type">DATE</span>,</span><br><span class="line">	dept_id <span class="type">INT</span></span><br><span class="line">);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/post/c24675b4/Users\84750\AppData\Roaming\Typora\typora-user-images\image-20220412094003699.png" alt="image-20220412094003699"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/post/c24675b4/Users\84750\AppData\Roaming\Typora\typora-user-images\image-20220412094011095.png" alt="image-20220412094011095"></p>
<h4 id="4-2-5-外键约束"><a href="#4-2-5-外键约束" class="headerlink" title="4.2.5 外键约束"></a>4.2.5 外键约束</h4><p>外键用来在两个表的数据之间建立连接，可以是一列或者多列。一个表 可以有一个或多个外键。外键对应的是参照完整性，一个表的外键可以为空 值，若不为空值，则每一个外键值必须等于另一个表中主键的某个值。<br>外键：首先它是表中的一个字段，虽可以不是本表的主键，但要对应另 外一个表的主键。外键的主要作用是保证数据引用的完整性，定义外键后， 不允许删除在另一个表中具有关联关系的行。外键的作用是保持数据的一致 性、完整性。例如，部门表tb_dept的主键是id，在员工表tb_emp5中有一个键deptId与这个id关联。<br>主表（父表）：对于两个具有关联关系的表而言，相关联字段中主键所 在的那个表即是主表。</p>
<p>从表（子表）：对于两个具有关联关系的表而言，相关联字段中外键所 在的那个表即是从表。<br>语法：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> 子表 <span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> 约束名 <span class="keyword">FOREIGN</span> KEY (外键) <span class="keyword">REFERENCES</span> 主表(主键);</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> employee <span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> fk_emp_dept <span class="keyword">FOREIGN</span> KEY (dept_id)</span><br><span class="line"><span class="keyword">REFERENCES</span> dept(deptid);</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/post/c24675b4/Users\84750\AppData\Roaming\Typora\typora-user-images\image-20220414112643882.png" alt="image-20220414112643882"></p>
<p>以上案例就是一个一对多的表关系。一个部门下有多个员工，一个员工从属一个部门。<br>常用的表关系【重点】有三种：一对一，一对多【自关联】，多对多</p>
<p>一对一：人与身份证</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">	一对一</span></span><br><span class="line"><span class="comment">	人 	身份证</span></span><br><span class="line"><span class="comment">	1 	   1</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> person(</span><br><span class="line">	pid <span class="type">INT</span> <span class="keyword">PRIMARY</span> KEY AUTO_INCREMENT,</span><br><span class="line">	pname <span class="type">VARCHAR</span>(<span class="number">50</span>),</span><br><span class="line">	pphone <span class="type">VARCHAR</span>(<span class="number">50</span>)</span><br><span class="line">);</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> idcard(</span><br><span class="line">	cid <span class="type">INT</span> <span class="keyword">PRIMARY</span> KEY,</span><br><span class="line">	cnum <span class="type">VARCHAR</span>(<span class="number">50</span>),</span><br><span class="line">	cstart <span class="type">DATE</span>,</span><br><span class="line">	cend <span class="type">DATE</span>,</span><br><span class="line">	cpublish <span class="type">VARCHAR</span>(<span class="number">200</span>)</span><br><span class="line">);</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> idcard <span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> fk_card_person <span class="keyword">FOREIGN</span> KEY(cid) <span class="keyword">REFERENCES</span> person(pid);</span><br></pre></td></tr></table></figure>

<p>一对多：部门与员工</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">	1.一对多</span></span><br><span class="line"><span class="comment">	部门 员工</span></span><br><span class="line"><span class="comment">	1 	N</span></span><br><span class="line"><span class="comment">	1 	1</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> department(</span><br><span class="line">	departid <span class="type">INT</span> <span class="keyword">PRIMARY</span> KEY AUTO_INCREMENT,</span><br><span class="line">	departname <span class="type">VARCHAR</span>(<span class="number">50</span>),</span><br><span class="line">	departnum <span class="type">INT</span> <span class="keyword">DEFAULT</span> <span class="number">0</span>,</span><br><span class="line">	departdesc <span class="type">VARCHAR</span>(<span class="number">200</span>)</span><br><span class="line">);</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> employee(</span><br><span class="line">	empid <span class="type">INT</span> <span class="keyword">PRIMARY</span> KEY AUTO_INCREMENT,</span><br><span class="line">	empname <span class="type">VARCHAR</span>(<span class="number">50</span>),</span><br><span class="line">	empsex <span class="type">CHAR</span>(<span class="number">2</span>) <span class="keyword">DEFAULT</span> <span class="string">&#x27;男&#x27;</span>,</span><br><span class="line">	empbirth <span class="type">DATE</span>,</span><br><span class="line">	empphone <span class="type">VARCHAR</span>(<span class="number">50</span>),</span><br><span class="line">	deptid <span class="type">INT</span> <span class="comment">-- FK</span></span><br><span class="line">);</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">alter table tabname add constratin 约束名 foreign key(字段) references 主表</span></span><br><span class="line"><span class="comment">(主键);</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> employee <span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> fk_emp_dept <span class="keyword">FOREIGN</span> KEY(deptid) <span class="keyword">REFERENCES</span> department(departid);</span><br></pre></td></tr></table></figure>

<p>多对多：用户与角色【中间表多列主键】</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 多对多的关系</span></span><br><span class="line"><span class="comment">用户 角色</span></span><br><span class="line"><span class="comment">1	 N</span></span><br><span class="line"><span class="comment">N 	1</span></span><br><span class="line"><span class="comment">N 	N</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> users(</span><br><span class="line">	uid <span class="type">INT</span> <span class="keyword">PRIMARY</span> KEY AUTO_INCREMENT,</span><br><span class="line">	uname <span class="type">VARCHAR</span>(<span class="number">50</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">UNIQUE</span>,</span><br><span class="line">	upwd <span class="type">VARCHAR</span>(<span class="number">50</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">	ustatus <span class="type">INT</span></span><br><span class="line">);</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> roles(</span><br><span class="line">	rid <span class="type">INT</span> <span class="keyword">PRIMARY</span> KEY AUTO_INCREMENT,</span><br><span class="line">	rname <span class="type">VARCHAR</span>(<span class="number">50</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line">);</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> userroles(</span><br><span class="line">	uid <span class="type">INT</span> ,</span><br><span class="line">	rid <span class="type">INT</span>,</span><br><span class="line">	<span class="keyword">PRIMARY</span> KEY(uid,rid)</span><br><span class="line">);</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> userroles <span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> fk_ur_user <span class="keyword">FOREIGN</span> KEY(uid) <span class="keyword">REFERENCES</span> users(uid);</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> userroles <span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> fk_ur_role <span class="keyword">FOREIGN</span> KEY(rid) <span class="keyword">REFERENCES</span> roles(rid);</span><br></pre></td></tr></table></figure>

<p>自关联：省市</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> cities(</span><br><span class="line">	cid <span class="type">INT</span> <span class="keyword">PRIMARY</span> KEY AUTO_INCREMENT,</span><br><span class="line">	cname <span class="type">VARCHAR</span>(<span class="number">50</span>),</span><br><span class="line">	pid <span class="type">INT</span> ,</span><br><span class="line">	<span class="keyword">CONSTRAINT</span> fk_pro_ci <span class="keyword">FOREIGN</span> KEY(pid) <span class="keyword">REFERENCES</span> cities(cid)</span><br><span class="line">)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="4-2-6-查看表结构"><a href="#4-2-6-查看表结构" class="headerlink" title="4.2.6 查看表结构"></a>4.2.6 查看表结构</h4><p>DESCRIBE&#x2F;DESC语句可以查看表的字段信息，其中包括字段名、字段 数据类型、是否为主键、是否有默认值等。语法规则如下：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DESCRIBE</span> 表名;</span><br></pre></td></tr></table></figure>

<p>或者简写为</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DESC</span> 表名;</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/post/c24675b4/Users\84750\AppData\Roaming\Typora\typora-user-images\image-20220414112718645.png" alt="image-20220414112718645"></p>
<p>其中，各个字段的含义分别解释如下<br>NULL：表示该列是否可以存储NULL值。<br>Key：表示该列是否已编制索引。PRI表示该列是表主键的一部分；<br>          UNI表示该列是UNIQUE索引的一部分；MUL表示在列中某个给定 值允许出现多次。<br>Default：表示该列是否有默认值，有的话指定值是多少。<br>Extra：表示可以获取的与给定列有关的附加信息，例如 AUTO_INCREMENT等。<br>查看表详细结构语句：<br>SHOW CREATE TABLE语句可以用来显示创建表时的CREATE TABLE 语句，语法格式如下：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> employee;</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/post/c24675b4/Users\84750\AppData\Roaming\Typora\typora-user-images\image-20220414112729120.png" alt="image-20220414112729120"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `employee` (</span><br><span class="line">	`emp_id` <span class="type">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT,</span><br><span class="line">	`emp_name` <span class="type">varchar</span>(<span class="number">50</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">	`emp_sex` <span class="type">char</span>(<span class="number">2</span>) <span class="keyword">DEFAULT</span> <span class="string">&#x27;男&#x27;</span>,</span><br><span class="line">	`emp_salary` <span class="type">float</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">	`emp_phone` <span class="type">varchar</span>(<span class="number">50</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">	`emp_birth` <span class="type">date</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">	`dept_id` <span class="type">int</span>(<span class="number">11</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">	<span class="keyword">PRIMARY</span> KEY (`emp_id`),</span><br><span class="line">	<span class="keyword">UNIQUE</span> KEY `emp_phone` (`emp_phone`),</span><br><span class="line">	KEY `fk_emp_dept` (`dept_id`),</span><br><span class="line"><span class="keyword">CONSTRAINT</span> `fk_emp_dept` <span class="keyword">FOREIGN</span> KEY (`dept_id`) <span class="keyword">REFERENCES</span> `dept`</span><br><span class="line">    (`deptid`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8</span><br></pre></td></tr></table></figure>

<h4 id="4-2-7-修改表结构"><a href="#4-2-7-修改表结构" class="headerlink" title="4.2.7 修改表结构"></a>4.2.7 修改表结构</h4><p>修改表指的是修改数据库中已经存在的数据表的结构。MySQL使用 ALTER TABLE语句修改表。常用的修改表的操作有修改表名、修改字段数 据类型或字段名、增加和删除字段、修改字段的排列位置、更改表的存储引擎、删除表的外键约束等。本节将对和修改表有关的操作进行讲解。</p>
<ol>
<li><p>修改表名</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> <span class="operator">&lt;</span>旧表名<span class="operator">&gt;</span> RENAME [<span class="keyword">TO</span>] <span class="operator">&lt;</span>新表名<span class="operator">&gt;</span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> employee RENAME <span class="keyword">TO</span> emp;</span><br></pre></td></tr></table></figure>
</li>
<li><p>修改字段的数据类型</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> <span class="operator">&lt;</span>表名<span class="operator">&gt;</span> MODIFY <span class="operator">&lt;</span>字段名<span class="operator">&gt;</span> <span class="operator">&lt;</span>数据类型<span class="operator">&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> emp MODIFY emp_name <span class="type">VARCHAR</span>(<span class="number">30</span>);</span><br></pre></td></tr></table></figure>
</li>
<li><p>修改字段名</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> <span class="operator">&lt;</span>表名<span class="operator">&gt;</span> CHANGE <span class="operator">&lt;</span>旧字段名<span class="operator">&gt;</span> <span class="operator">&lt;</span>新字段名<span class="operator">&gt;</span> <span class="operator">&lt;</span>新数据类型<span class="operator">&gt;</span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> emp CHANGE dept_id deptid <span class="type">INT</span>;</span><br></pre></td></tr></table></figure>
</li>
<li><p>添加字段</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> <span class="operator">&lt;</span>表名<span class="operator">&gt;</span> <span class="keyword">ADD</span> <span class="operator">&lt;</span>新字段名<span class="operator">&gt;</span> <span class="operator">&lt;</span>新字段类型<span class="operator">&gt;</span> <span class="operator">&lt;</span>约束条件<span class="operator">&gt;</span> [<span class="keyword">FIRST</span><span class="operator">|</span>AFTER 已存在字段名];</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> emp <span class="keyword">ADD</span> empaddr <span class="type">VARCHAR</span>(<span class="number">20</span>);</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> emp <span class="keyword">ADD</span> empaddr <span class="type">VARCHAR</span>(<span class="number">20</span>) AFTER empsex;</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> emp <span class="keyword">ADD</span> empnum <span class="type">VARCHAR</span>(<span class="number">20</span>) <span class="keyword">FIRST</span>;</span><br></pre></td></tr></table></figure></li>
</ol>
<p>比如条件null</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> tabname <span class="keyword">ADD</span> column1 <span class="type">VARCHAR</span>(<span class="number">12</span>) <span class="keyword">not</span> <span class="keyword">null</span>;</span><br></pre></td></tr></table></figure>

<ol start="5">
<li><p>删除字段</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> <span class="operator">&lt;</span>表名<span class="operator">&gt;</span> <span class="keyword">DROP</span> <span class="operator">&lt;</span>字段名<span class="operator">&gt;</span> ;</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> emp <span class="keyword">DROP</span> empno;</span><br></pre></td></tr></table></figure>
</li>
<li><p>修改字段的排序位置</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> <span class="operator">&lt;</span>表名<span class="operator">&gt;</span> MODIFY <span class="operator">&lt;</span>字段<span class="number">1</span><span class="operator">&gt;</span> <span class="operator">&lt;</span>数据类型<span class="operator">&gt;</span> <span class="keyword">FIRST</span><span class="operator">|</span>AFTER <span class="operator">&lt;</span>字段<span class="number">2</span><span class="operator">&gt;</span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> emp MODIFY deptid <span class="type">INT</span> AFTER empphone;</span><br></pre></td></tr></table></figure>
</li>
<li><p>删除表的外键约束</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> <span class="operator">&lt;</span>表名<span class="operator">&gt;</span> <span class="keyword">DROP</span> <span class="keyword">FOREIGN</span> KEY <span class="operator">&lt;</span>外键约束名<span class="operator">&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> emp <span class="keyword">DROP</span> <span class="keyword">FOREIGN</span> KEY fk_emp_dept;</span><br></pre></td></tr></table></figure>
</li>
<li><p>更改表的存储引擎</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> <span class="operator">&lt;</span>表名<span class="operator">&gt;</span> ENGINE<span class="operator">=</span><span class="operator">&lt;</span>更改后的存储引擎名<span class="operator">&gt;</span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> tb_deptment3 ENGINE<span class="operator">=</span>MyISAM;</span><br></pre></td></tr></table></figure>
</li>
<li><p>删除数据表</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> [IF <span class="keyword">EXISTS</span>]表<span class="number">1</span>, 表<span class="number">2</span>,…表n;</span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="练习：-1"><a href="#练习：-1" class="headerlink" title="练习："></a>练习：</h3><p><strong>练习一：</strong></p>
<ol>
<li><p>创建数据库company,在库中创建两个表offices和employees表 offices表结构：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/post/c24675b4/Users\84750\AppData\Roaming\Typora\typora-user-images\image-20220414112940650.png" alt="image-20220414112940650"></p>
<p>employees表结构</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/post/c24675b4/Users\84750\AppData\Roaming\Typora\typora-user-images\image-20220414112949528.png" alt="image-20220414112949528"></p>
</li>
<li><p>查看该库下几个表以及查看两张表结构。</p>
</li>
<li><p>将表employees的mobile字段修改到officeCode字段后面。 </p>
</li>
<li><p>将表employees的birth字段改名为employee_birth。 </p>
</li>
<li><p>修改sex字段，数据类型为CHAR(1)，非空约束。 </p>
</li>
<li><p>删除字段note。 </p>
</li>
<li><p>增加字段名favoriate_activity，数据类型为VARCHAR(100)。 </p>
</li>
<li><p>删除表offices。</p>
</li>
<li><p>将表employees名称修改为employees_info。</p>
</li>
</ol>
<p><strong>练习二：</strong></p>
<p>创建数据库Market，在Market中创建数据表customers</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/post/c24675b4/Users\84750\AppData\Roaming\Typora\typora-user-images\image-20220414112959552.png" alt="image-20220414112959552"></p>
<ol>
<li><p>创建数据表customers，在c_num字段上添加主键约束和自增约 束，在c_birth字段上添加非空约束。</p>
</li>
<li><p>将c_contact字段插入c_birth字段后面。 </p>
</li>
<li><p>将c_name字段数据类型改为VARCHAR(70)。 </p>
</li>
<li><p>将c_contact字段改名为c_phone。</p>
</li>
<li><p>增加c_gender字段，数据类型为CHAR(1)。 </p>
</li>
<li><p>将表名修改为customers_info。</p>
</li>
<li><p>删除字段c_city。 </p>
</li>
<li><p>修改数据表的存储引擎为MyISAM。 </p>
</li>
<li><p>在Market中创建数据表orders。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/post/c24675b4/Users\84750\AppData\Roaming\Typora\typora-user-images\image-20220414113033879.png" alt="image-20220414113033879"></p>
</li>
<li><p>创建数据表orders，在o_num字段上添加主键约束和自增约束，在 c_id字段上添加外键约束，关联customers表中的主键c_num。 </p>
</li>
<li><p>删除orders表的外键约束，然后删除表customers。</p>
</li>
</ol>
<p><strong>练习三：</strong></p>
<p>1.创建数据库MySchool </p>
<p>2.创建以下数据表<br>1&gt; 班级表：Grade表</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/post/c24675b4/Users\84750\AppData\Roaming\Typora\typora-user-images\image-20220414113044620.png" alt="image-20220414113044620"></p>
<p>2&gt; 学生表： Student表</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/post/c24675b4/Users\84750\AppData\Roaming\Typora\typora-user-images\image-20220414113051379.png" alt="image-20220414113051379"></p>
<p>3&gt; 科目表：Subjects表</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/post/c24675b4/Users\84750\AppData\Roaming\Typora\typora-user-images\image-20220414113056556.png" alt="image-20220414113056556"></p>
<p>4&gt; 成绩表：Result表</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/post/c24675b4/Users\84750\AppData\Roaming\Typora\typora-user-images\image-20220414113103096.png" alt="image-20220414113103096"></p>
<p>5&gt; 表关系：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/post/c24675b4/Users\84750\AppData\Roaming\Typora\typora-user-images\image-20220414113112365.png" alt="image-20220414113112365"></p>
<p><strong>建表的时候，如果选择数据类型</strong></p>
<ol>
<li><p><strong>整数和浮点数</strong><br>如果不需要小数部分，就使用整数来保存数据；如果需要表示小数部分，就使用浮点数类型。对于浮点数据列，存入的数值会对该列定义的小数位进行四舍五入。例如，假设列的值的范围为1~99999，若使用整数，则 MEDIUMINT UNSIGNED是 好的类型；若需要存储小数，则使用FLOAT 类型<br>浮点类型包括FLOAT和DOUBLE类型。DOUBLE类型精度比FLOAT类型高，因此要求存储精度较高时应选择DOUBLE类型</p>
</li>
<li><p><strong>浮点数和定点数浮点数</strong></p>
<p>FLOAT、DOUBLE相对于定点数DECIMAL的优势是：在长度一定的情况下，浮点数能表示更大的数据范围。由于浮点数容易产生误差，因 此对精确度要求比较高时，建议使用DECIMAL来存储。DECIMAL在MySQL中是以字符串存储的，用于定义货币等对精确度要求较高的数据。 在数据迁移中，float(M,D)是非标准SQL定义，数据库迁移可能会出现问题， 好不要这样使用。另外，两个浮点数进行减法和比较运算时也容易出 问题，因此在进行计算的时候，一定要小心。进行数值比较时， 好使用DECIMAL类型</p>
</li>
<li><p><strong>日期与时间类型</strong><br>MySQL对于不同种类的日期和时间有很多数据类型，比如YEAR和TIME。如果只需要记录年份，则使用YEAR类型即可；如果只记录时间，则使用TIME类型。<br>如果同时需要记录日期和时间，则可以使用TIMESTAMP或者DATETIME类型。由于 TIMESTAMP列的取值范围小于DATETIME的取值范围，因此存储范围较大的日期 好使用DATETIME。<br>TIMESTAMP也有一个DATETIME不具备的属性。默认的情况下，当插入一条记录但并没有指定TIMESTAMP这个列值时，MySQL会把TIMESTAMP列设为当前的时间。因此当需要插入记录的同时插入当前时间时，使用TIMESTAMP是方便的。另外，TIMESTAMP在空间上比 DATETIME更有效。 </p>
</li>
<li><p><strong>CHAR</strong>与<strong>VARCHAR</strong>之间的特点与选择<br>CHAR和VARCHAR的区别如下<br>CHAR是固定长度字符，VARCHAR是可变长度字符。<br>CHAR会自动补空格，VARCHAR不自动补。<br>CHAR是固定长度，所以它的处理速度比VARCHAR的速度要快，但是它的缺点是浪费存储空间，所以对存储不大但在速度上有要求的可以使用CHAR类型，反之可以使用 VARCHAR类型来实现。</p>
</li>
</ol>
<h2 id="五、数据CRUD操作"><a href="#五、数据CRUD操作" class="headerlink" title="五、数据CRUD操作"></a>五、数据CRUD操作</h2><h3 id="1、插入数据"><a href="#1、插入数据" class="headerlink" title="1、插入数据"></a>1、插入数据</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> 表名 <span class="keyword">VALUES</span>(val_list);</span><br><span class="line">或</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> 表名(col_list) <span class="keyword">VALUES</span>(val_list);</span><br></pre></td></tr></table></figure>

<p>可以插入多条记录</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> 表名(col_list) <span class="keyword">VALUES</span>(val_list1),(val_list2),(val_list3),(val_list4);</span><br></pre></td></tr></table></figure>

<p>备份数据表</p>
<p>如果表不存在，此时</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> emp_bak <span class="keyword">AS</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp;</span><br></pre></td></tr></table></figure>

<p>如果表存在，此时</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> emp_bak <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp;</span><br></pre></td></tr></table></figure>

<h3 id="2、更新数据"><a href="#2、更新数据" class="headerlink" title="2、更新数据"></a>2、更新数据</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> table_name <span class="keyword">SET</span> col<span class="operator">=</span>val,col<span class="operator">=</span>val [<span class="keyword">WHERE</span> <span class="operator">&lt;</span><span class="keyword">condition</span><span class="operator">&gt;</span>];</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> emp <span class="keyword">SET</span> empname<span class="operator">=</span><span class="string">&#x27;jerry&#x27;</span>,empaddr<span class="operator">=</span><span class="string">&#x27;延安&#x27;</span>,empphone<span class="operator">=</span><span class="string">&#x27;118&#x27;</span> <span class="keyword">WHERE</span> empid<span class="operator">=</span><span class="number">1</span>;</span><br></pre></td></tr></table></figure>

<h3 id="3、删除数据"><a href="#3、删除数据" class="headerlink" title="3、删除数据"></a>3、删除数据</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> table_name [<span class="keyword">WHERE</span> <span class="operator">&lt;</span><span class="keyword">condition</span><span class="operator">&gt;</span>];</span><br></pre></td></tr></table></figure>

<p>如果删除语句没where,此时会将数据表中的记录全部删除，类似TRUNCATE TABLE.</p>
<p> TRUNCATE将直接删除原来的表，并重新创建一个表，其语法结构为 TRUNCATE TABLE table_name。        </p>
<p>TRUNCATE直接删除表而不是删除记录，因此执行速度比DELETE快。而且不能用在有主外键关系的主表中。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mysql为什么不建议<span class="keyword">delete</span>数据?</span><br><span class="line"><span class="keyword">delete</span>对性能会有影响，一般不建议硬性<span class="keyword">delete</span>数据，而是标记deleted <span class="operator">=</span> <span class="number">1</span>这种软删除</span><br><span class="line">为啥呢？</span><br><span class="line">根据之前了解的mysql底层存储原理 小存储单元page页，无论是非叶子节点page存的是索引key和指针，还是叶子节点存的是行数据.</span><br><span class="line"><span class="number">1.</span>当删除大量数据时</span><br><span class="line">MySQL内部不会真正删除空间，而且做标记删除，即将delflag:N修改为delflag:Y，<span class="keyword">commit</span>之后会会被purge进入删除链表，如果下一次<span class="keyword">insert</span>更大的记录，<span class="keyword">delete</span>之后的空间不会被重用，如果插入的记录小于等于<span class="keyword">delete</span>的记录空会被重用</span><br><span class="line"><span class="number">2.</span>当少量删除中间数据时</span><br><span class="line">你在中间删了某些个值，实际上只是找到那个page页找到对应的数据做删除标记，并不会实际影响page 页已经占的大小，这块空间可能也永远不会被利用，产生了内存碎片导致索引频繁分裂，影响<span class="keyword">SQL</span>执行计划的稳定性</span><br><span class="line">正确姿势：</span><br><span class="line">使用deleted <span class="operator">=</span> <span class="number">1</span> 字段来软删除，保证索引连续性，</span><br><span class="line">必要时，可将deleted <span class="operator">=</span> <span class="number">0</span>的字段完整迁移到新表，解决碎片问题</span><br></pre></td></tr></table></figure>

<h3 id="4、查询数据"><a href="#4、查询数据" class="headerlink" title="4、查询数据"></a>4、查询数据</h3><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/post/c24675b4/Users\84750\AppData\Roaming\Typora\typora-user-images\image-20220414113358996.png" alt="image-20220414113358996"></p>
<p>MySQL从数据表中查询数据的基本语句为SELECT语句。SELECT语句的基本格式是：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span><span class="keyword">SELECT</span>  字段列表   <span class="keyword">FROM</span>  表<span class="number">1</span>,表<span class="number">2.</span>.. <span class="keyword">WHERE</span> 表达式   <span class="keyword">GROUP</span> <span class="keyword">BY</span>  字段   <span class="keyword">HAVING</span> 条件  </span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> 字段 LIMIT   [<span class="operator">&lt;</span><span class="keyword">offset</span><span class="operator">&gt;</span>,] <span class="operator">&lt;</span><span class="type">row</span> count<span class="operator">&gt;</span>]</span><br></pre></td></tr></table></figure>

<p> {* | &lt;字段列表&gt;}包含星号通配符和字段列表，表示查询的字段。其中，字段列表至少包含一个字段名称，如果要查询多个字段，多个字段之间用逗号隔开， 后一个字段后不加逗号。<br> FROM &lt;表1&gt;,&lt;表2&gt;…，表1和表2表示查询数据的来源，可以是单个或者多个。<br>WHERE子句是可选项，如果选择该项，将限定查询行必须满足的查询条件。<br>GROUP BY &lt;字段&gt;，该子句告诉MySQL如何显示查询出来的数据，并按照指定的字段分组。<br>[ORDER BY &lt;字段&gt;]，该子句告诉MySQL按什么样的顺序显示查询出来的数据，可以进行的排序有升序<br>（ASC）、降序（DESC）。<br>[LIMIT [,] ]，该子句告诉MySQL每次显示查询 出来的数据条数。 </p>
<h4 id="单表查询："><a href="#单表查询：" class="headerlink" title="单表查询："></a>单表查询：</h4><p><strong>1&gt; 查询所有字段</strong> </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> 表名;</span><br></pre></td></tr></table></figure>

<p><strong>2&gt; 查询指定字段</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> 列名 <span class="keyword">FROM</span> 表名;</span><br></pre></td></tr></table></figure>

<p><strong>3&gt; 查询多个字段</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> 字段名<span class="number">1</span>,字段名<span class="number">2</span>,…,字段名n <span class="keyword">FROM</span> 表名;</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> empid,empname,empsex,empaddr,empbirth,empphone,deptid <span class="keyword">FROM</span> emp;</span><br></pre></td></tr></table></figure>

<p>查询的时候可以起别名</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> e.`empid` <span class="keyword">AS</span> 员工编号 ,e.`empname` <span class="keyword">AS</span> 员工名字 <span class="keyword">FROM</span> emp e;</span><br></pre></td></tr></table></figure>

<p><strong>4&gt; 查询指定记录</strong><br>数据库中包含大量的数据，根据特殊要求，可能只需要查询表中的指定数据，即对数据进行过滤。在<br>SELECT语句中，通过WHERE子句可以对数 据进行过滤，语法格式为： </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> 字段名<span class="number">1</span>,字段名<span class="number">2</span>,…,字段名n <span class="keyword">FROM</span> 表名 <span class="keyword">WHERE</span> 查询条件</span><br></pre></td></tr></table></figure>

<p>如：查询性别为女的员工信息</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> empsex<span class="operator">=</span><span class="string">&#x27;女&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p><strong>5&gt;带IN关键字的查询</strong><br>N操作符用来查询满足指定范围内的条件的记录，使用IN操作符，将所有检索条件用括号括起来，检索条件之间用逗号分隔开，只要满足条件范围内的一个值即为匹配项。<br>在IN关键字前面加上了NOT关键字，这使得查询的结果与前面一个的结果正好相反，</p>
<p>如：查询编号为 1 4 8 10 的员工信息</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> empid<span class="operator">=</span><span class="number">1</span> <span class="keyword">OR</span> empid<span class="operator">=</span><span class="number">4</span> <span class="keyword">OR</span> empid<span class="operator">=</span><span class="number">8</span> <span class="keyword">OR</span> empid<span class="operator">=</span><span class="number">10</span>;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> empid <span class="keyword">IN</span> (<span class="number">1</span>,<span class="number">4</span>,<span class="number">8</span>,<span class="number">10</span>);</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> empid <span class="keyword">NOT</span> <span class="keyword">IN</span> (<span class="number">1</span>,<span class="number">4</span>,<span class="number">8</span>,<span class="number">10</span>);</span><br></pre></td></tr></table></figure>

<p><strong>6&gt;带BETWEEN AND的范围查询</strong><br>BETWEEN AND用来查询某个范围内的值，该操作符需要两个参数,即范围的开始值和结束值，如果字段值满足指定的范围查询条件，则这些记录被返回。<br>BETWEEN  AND操作符前可以加关键字NOT，表示指定范围之外的 值，如果字段值不满足指定的范围内的值，则这些记录被返回。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> empid<span class="operator">&gt;=</span><span class="number">6</span> <span class="keyword">AND</span> empid<span class="operator">&lt;=</span><span class="number">10</span>;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> empid <span class="keyword">BETWEEN</span> <span class="number">6</span> <span class="keyword">AND</span> <span class="number">10</span>;</span><br></pre></td></tr></table></figure>

<p><strong>7&gt;带LIKE的字符匹配查询</strong><br>通配符是一种在SQL的WHERE条件子句中拥有特殊意思的字符。SQL 语句中支持多种通配符，可以和<br>LIKE一起使用的通配符有‘%’和‘_’。 </p>
<ol>
<li><p>百分号通配符‘%’，匹配任意长度的字符，甚至包括零字符</p>
</li>
<li><p>下划线通配符‘_’，一次只能匹配任意一个字符 </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> empname <span class="keyword">LIKE</span> <span class="string">&#x27;a%&#x27;</span>; <span class="comment">-- 以a开头</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> empname <span class="keyword">LIKE</span> <span class="string">&#x27;%a&#x27;</span>; <span class="comment">-- 以a结尾</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> empname <span class="keyword">LIKE</span> <span class="string">&#x27;%a%&#x27;</span>; <span class="comment">-- 包含a</span></span><br></pre></td></tr></table></figure>

<p>名字是两个字母的而且是a开头的</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> empname <span class="keyword">LIKE</span> <span class="string">&#x27;a_&#x27;</span>;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> empaddr <span class="keyword">IN</span> (<span class="string">&#x27;西安&#x27;</span>,<span class="string">&#x27;武当山&#x27;</span>);</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> empaddr <span class="operator">=</span><span class="string">&#x27;西安&#x27;</span> <span class="keyword">OR</span> empaddr <span class="operator">=</span> <span class="string">&#x27;武当山&#x27;</span>;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> empaddr <span class="keyword">LIKE</span> <span class="string">&#x27;西安%&#x27;</span>;</span><br></pre></td></tr></table></figure></li>
</ol>
<p><strong>8&gt;查询空值</strong><br>数据表创建的时候，设计者可以指定某列中是否包含空值（NULL）在SELECT语句中使用IS NULL子句，可以查询某字段内容为空记录。与IS NULL相反的是NOT NULL，该关键字查找字段不为空的记录。</p>
<p>空的查询 查询地址为空的员工信息</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> empaddr <span class="keyword">IS</span> <span class="keyword">NULL</span>;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> empaddr <span class="operator">=</span><span class="string">&#x27;&#x27;</span>;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> empaddr <span class="keyword">IS</span> <span class="keyword">NULL</span> <span class="keyword">OR</span> empaddr<span class="operator">=</span><span class="string">&#x27;&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>非空查询</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> empaddr <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> empaddr <span class="operator">!=</span><span class="string">&#x27;&#x27;</span>;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> empaddr <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">AND</span> empaddr<span class="operator">!=</span><span class="string">&#x27;&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p><strong>9&gt;带AND的多条件查询</strong><br>MySQL在WHERE子句中使用AND操作符限定只有满足所有查询条件的记录才会被返回。可以使用AND 连接两个甚至多个查询条件，多个条件表达式之间用AND分开</p>
<p>如：查询性别为男同时地址是西安锦业路</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> empsex<span class="operator">=</span><span class="string">&#x27;男&#x27;</span> <span class="keyword">AND</span> empaddr<span class="operator">=</span><span class="string">&#x27;西安锦业路&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p><strong>10&gt;带OR的多条件查询</strong><br>与AND相反，在WHERE声明中使用OR操作符，表示只需要满足其中一个条件的记录即可返回。OR也可以连接两个甚至多个查询条件，多个条件表达式之间用OR分开</p>
<p><strong>11&gt;查询结果不重复</strong></p>
<p>在SELECT语句中，可以使用DISTINCT关键字指示MySQL消除重复的记录值。 </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> empid,empname,empsex <span class="keyword">FROM</span> emp;</span><br></pre></td></tr></table></figure>

<p><strong>12&gt;对查询结果排序</strong><br>使用ORDER BY子句对指定的列数据进行排序。 desc:倒叙  asc:默认值，升序</p>
<ol>
<li><p>单列排序 </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">ORDER</span> <span class="keyword">BY</span> empid <span class="keyword">DESC</span>;</span><br></pre></td></tr></table></figure>
</li>
<li><p>多列排序</p>
</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">ORDER</span> <span class="keyword">BY</span> empid <span class="keyword">DESC</span> ,deptid <span class="keyword">DESC</span>;</span><br></pre></td></tr></table></figure>

<p><strong>13&gt;聚合函数</strong><br>有时候并不需要返回实际表中的数据，而只是对数据进行总结。 MySQL提供一些查询功能，可以对获取的数据进行分析和报告。这些函数 的功能有：计算数据表中记录行数的总数、计算某个字段列下数据的<br>总和， 以及计算表中某个字段下的 大值、 小值或者平均值。常用的聚合函数 MAX()、MIN()、<br>COUNT()、SUM()、AVG()。</p>
<table>
<thead>
<tr>
<th><strong>函数</strong></th>
<th><strong>作用</strong></th>
</tr>
</thead>
<tbody><tr>
<td>AVG()</td>
<td>返回某列的平均值</td>
</tr>
<tr>
<td>COUNT()</td>
<td>返回某列的行数</td>
</tr>
<tr>
<td>MAX()</td>
<td>返回某列的 大值</td>
</tr>
<tr>
<td>MIN()</td>
<td>返回某列的 小值</td>
</tr>
<tr>
<td>SUM()</td>
<td>返回某列值的和</td>
</tr>
</tbody></table>
<p>1）	COUNT()函数统计数据表中包含的记录行的总数，或者根据查询结果 返回列中包含的数据行数。其使用方法有两种： </p>
<p>​       COUNT(*)计算表中总的行数，不管某列是否有数值或者为空值。</p>
<p>​       COUNT(字段名)计算指定列下总的行数，计算时将忽略空值的行。<br>2）	SUM()是一个求总和的函数，返回指定列值的总和。 SUM()函数在计算时，忽略列值为NULL的行。<br>3）	AVG()函数通过计算返回的行数和每一行数据的和，求得指定列数据的平均值。<br>4）	MAX()函数返回指定列中的 大值。<br>MAX()函数除了用来找出 大的列值或日期值之外，还可以返回任意列 中的 大值，包括返回字符类型<br>的 大值。在对字符类型数据进行比较 时，按照字符的ASCII码值大小进行比较，从a~z，a的ASCII码小，z的 大。在比较时，先比较第一个字母，如果相等，继续比较下一个字符，一直到两个字符不相等或者字符结束为止。例如，‘b’与‘t’比较时，‘t’为 大值；“bcd”与“bca”比较时，“bcd”为 大值。<br>5）	MIN()函数与MAX()函数类似，不仅适用于查找数值类型，也可应用于字符类型。<br><strong>14&gt;分组查询</strong><br>GROUP  BY关键字通常和集合函数一起使用</p>
<p>查询每个部门的人数</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> deptid,<span class="built_in">COUNT</span>(<span class="number">1</span>) <span class="keyword">FROM</span> emp <span class="keyword">GROUP</span> <span class="keyword">BY</span> deptid;</span><br></pre></td></tr></table></figure>

<p>统计每个部门的男女人数</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> deptid,empsex,<span class="built_in">COUNT</span>(<span class="number">1</span>) <span class="keyword">FROM</span> emp <span class="keyword">GROUP</span> <span class="keyword">BY</span> deptid,empsex;</span><br></pre></td></tr></table></figure>

<p>分组后再排序</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> deptid,empsex,<span class="built_in">COUNT</span>(<span class="number">1</span>) <span class="keyword">FROM</span> emp <span class="keyword">GROUP</span> <span class="keyword">BY</span> deptid,empsex <span class="keyword">ORDER</span> <span class="keyword">BY</span></span><br><span class="line">deptid <span class="keyword">DESC</span>,<span class="built_in">COUNT</span>(<span class="number">1</span>) <span class="keyword">DESC</span>;</span><br></pre></td></tr></table></figure>

<p><strong>15&gt;使用HAVING过滤分组</strong><br>GROUP BY可以和HAVING一起限定显示记录所需满足的条件，只有满 足条件的分组才会被显示对于统计的每个部门的男女人数只要大于等于3的信息 </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> deptid,empsex,<span class="built_in">COUNT</span>(<span class="number">1</span>) <span class="keyword">FROM</span> emp <span class="keyword">GROUP</span> <span class="keyword">BY</span> deptid,empsex <span class="keyword">HAVING</span></span><br><span class="line"><span class="built_in">COUNT</span>(<span class="number">1</span>)<span class="operator">&gt;=</span><span class="number">3</span> <span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="built_in">COUNT</span>(<span class="number">1</span>) <span class="keyword">DESC</span>,deptid <span class="keyword">DESC</span>;</span><br></pre></td></tr></table></figure>

<p><strong>16&gt;LIMIT</strong><br>SELECT返回所有匹配的行，有可能是表中所有的行，若仅仅需要返回 第一行或者前几行，可使用LIMIT 关键字。</p>
<h3 id="练习：数据修改与删除"><a href="#练习：数据修改与删除" class="headerlink" title="练习：数据修改与删除"></a>练习：数据修改与删除</h3><ol>
<li>   将地址是西安市的更新为 西安科技二路</li>
<li>   将S1001的email修改为空的字符串</li>
<li>   将第二门课的名字更新为 java基础，课时为60 ，班级是二年级</li>
<li>   将S1001 ，课程编号为 2 的成绩 提高 5分</li>
<li>   将 S1004 ,课程编号为3 的成绩更新为60，考试时间更新为 2015-10-10</li>
<li>   经核实 S1004 课程编号为2 的 缺考</li>
<li>   将计算机网络课程删除掉</li>
</ol>
<p>数据查询【部分函数后面章节介绍，学习完毕后继续完成】：<br>1、	查询全部一年级的学生信息。<br>2、	查询全部二年级的学生的姓名和电话。<br>3、	查询全部一年级女同学的信息。<br>4、	查询课时超过60的科目信息。<br>5、	查询二年级的科目名称<br>6、	查询二年级男同学的姓名和住址。<br>7、	查询无电子邮件的学生姓名和年级信息。<br>8、	查询出生日期在1992年之后的男学生姓名和年级信息。<br>9、	参加了日期为2015年7月3日的“计算机基本原理”科目考试的成绩信息<br>10、	按照出生日期查询一年级的学生信息。<br>11、	按成绩由高到低的次序查询参加编号为1的科目考试信息。<br>12、	查询2015年7月1日参加“MySQL深入”考试的前2名学员成绩信息。<br>13、	查询课时 多的科目名称及课时。<br>14、	查询年龄 小的学生所在的年级及姓名。<br>15、	查询考试的 低分出现在哪个科目<br>16、	查询学号为“s1001”的学生参加过的所有考试信息，并按照时间前后次序显示。<br>17、	查询年龄超过25周岁的学生信息。<br>18、	查询1月份过生日的学生信息<br>19、	查询今天过生日的学生姓名及所在年级。<br>20、	新生入学，为其分配一个Email地址，规则如下：S1+当前日期 <a href="mailto:&#x2b;&#64;&#x62;&#100;&#x2e;&#99;&#111;&#109;">&#x2b;&#64;&#x62;&#100;&#x2e;&#99;&#111;&#109;</a><br>21、	查询住址为“雁塔区”的学生姓名、电话、住址<br>22、	查询名称中含有“计算机”字样科目名称、学时及所属年级，并按年级由低到高显示。<br>23、	查询电话中含有以“130”开头的学生姓名，住址和电话。<br>24、	查询姓“赵”的学号、姓名和住址。<br>25、	统计一年级女生的总人数。<br>26、	查询李四总成绩<br>27、	学号为s1003的学生所有课总成绩<br>28、	学号为s1003的学生考试的平均分。<br>29、	查询一年级的科目“Mysql”的 高分、 低分、平均分。<br>30、	查询每个年级的总学时数，并按照升序排列。<br>31、	查询每个参加考试的学员的平均分。（Group by 学号）<br>32、	查询每门课程的平均分，并按照降序排列。（group by 课程）<br>33、	查询每个学生参加的所有考试的总分，并按照降序排列。（group by 学号）<br>34、	查询一年级的平均年龄。<br>35、	查询每个年级西安地区的学生人数。<br>36、	查询参加考试的学生中，平均分及格的学生记录，并按照平均成绩降序排列<br>37、	查询参加考试至少一次考试不及格的学生学号、姓名、不及格次数。<br>38、	查询学生姓名、所属年级名称及联系电话。<br>39、	查询年级编号为1的科目名称、年级名称及学时。<br>40、	查询参加科目编号为1的考试的学生姓名、分数、考试日期。<br>41、	查询学号为s1001的学生参加的考试科目名称、分数、考试日期。<br>42、	查询所有科目的参考信息（某些科目可能还没有被考试过）<br>43、	查询没有被考过的科目信息。</p>
<h2 id="六、连接查询和子查询"><a href="#六、连接查询和子查询" class="headerlink" title="六、连接查询和子查询"></a>六、连接查询和子查询</h2><h3 id="6-1-链接查询"><a href="#6-1-链接查询" class="headerlink" title="6.1 链接查询"></a>6.1 链接查询</h3><p>连接是关系数据库模型的主要特点。连接查询是关系数据库中 主要的查询，主要包括内连接、外连接等。通过连接运算符可以实现多个表查询。 在关系数据库管理系统中，表建立时各数据之间的关系不必确定，常把一个实体的所有信息存放在一个表中。当查询数据时，通过连接操作查询出存放在多个表中的不同实体的信息。当两个或多个表中存在相同意义的字段时，便可以通过这些字段对不同的表进行连接查询。本节将介绍多表之间的内连接查询、外连接查询以及复合条件连接查询.</p>
<h4 id="1-内连接查询"><a href="#1-内连接查询" class="headerlink" title="1.内连接查询"></a>1.内连接查询</h4><p>内连接（INNER JOIN）使用比较运算符进行表间某（些）列数据的比较操作，并列出这些表中与连接条件相匹配的数据行，组合成新的记录，也就是说，在内连接查询中，只有满足条件的记录才能出现在结果关系中。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> dept d <span class="keyword">INNER</span> <span class="keyword">JOIN</span> emp e <span class="keyword">ON</span> d.`deptid`<span class="operator">=</span>e.`deptid`;</span><br></pre></td></tr></table></figure>

<h4 id="2-外连接查询"><a href="#2-外连接查询" class="headerlink" title="2.外连接查询"></a>2.外连接查询</h4><p><strong>左外连接</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> dept <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> emp <span class="keyword">ON</span> dept.`deptid`<span class="operator">=</span>emp.`deptid`</span><br></pre></td></tr></table></figure>

<p><strong>右外连接</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> dept.<span class="operator">*</span>,emp.<span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">RIGHT</span> <span class="keyword">JOIN</span> dept <span class="keyword">ON</span> dept.`deptid`<span class="operator">=</span>emp.`deptid`</span><br></pre></td></tr></table></figure>

<h3 id="6-2-子查询"><a href="#6-2-子查询" class="headerlink" title="6.2 子查询"></a>6.2 子查询</h3><h4 id="1-子查询"><a href="#1-子查询" class="headerlink" title="1)子查询"></a>1)子查询</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查询员工信息，并展示员工所在的部门名字</span></span><br><span class="line"><span class="keyword">SELECT</span> emp.<span class="operator">*</span>, (<span class="keyword">SELECT</span> deptname <span class="keyword">FROM</span> dept <span class="keyword">WHERE</span></span><br><span class="line">dept.`deptid`<span class="operator">=</span>emp.`deptid`)deptname</span><br><span class="line"><span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> emp.`deptid` <span class="keyword">IN</span> (<span class="keyword">SELECT</span> deptid <span class="keyword">FROM</span> dept)</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查询用户锁拥有的角色</span></span><br><span class="line"><span class="keyword">SELECT</span> ur.<span class="operator">*</span>,</span><br><span class="line">	(<span class="keyword">SELECT</span> users.`uname` <span class="keyword">FROM</span> users <span class="keyword">WHERE</span> users.`uid`<span class="operator">=</span>ur.`uid`) uname,</span><br><span class="line">	(<span class="keyword">SELECT</span> roles.`rname` <span class="keyword">FROM</span> roles <span class="keyword">WHERE</span> roles.`rid`<span class="operator">=</span>ur.`rid`) rname</span><br><span class="line">	<span class="keyword">FROM</span> userroles ur</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查询成绩最高的学生信息</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> xueshenbiao <span class="keyword">WHERE</span> xuehao <span class="keyword">IN</span></span><br><span class="line">	(</span><br><span class="line">		<span class="keyword">SELECT</span> xuehao <span class="keyword">FROM</span> 成绩表 <span class="keyword">WHERE</span> 成绩</span><br><span class="line">		<span class="operator">=</span>(<span class="keyword">SELECT</span> <span class="built_in">MAX</span>(chengji) <span class="keyword">FROM</span> 成绩表)</span><br><span class="line">	);</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查询考试没有及格的学生信息</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> xueshengbiao <span class="keyword">WHERE</span> xuehao <span class="keyword">IN</span> (</span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> xuehao <span class="keyword">FROM</span> 成绩表 <span class="keyword">WHERE</span> chengji<span class="operator">&lt;</span><span class="number">60</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查询两门课以上不及格的学生信息</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> xuesb <span class="keyword">WHERE</span> xuhao <span class="keyword">IN</span>(<span class="keyword">SELECT</span> xh <span class="keyword">FROM</span> chengjibao <span class="keyword">WHERE</span> cj<span class="operator">&lt;</span><span class="number">60</span></span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> xh <span class="keyword">HAVING</span> <span class="built_in">COUNT</span>(<span class="number">1</span>)<span class="operator">&gt;</span><span class="number">1</span>) ;</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查询平均分低于总平均的记录</span></span><br><span class="line"><span class="keyword">SELECT</span> studentno,<span class="built_in">AVG</span>(studentresult)</span><br><span class="line"><span class="keyword">FROM</span> <span class="keyword">result</span> <span class="keyword">GROUP</span> <span class="keyword">BY</span> studentno <span class="keyword">HAVING</span></span><br><span class="line"><span class="built_in">AVG</span>(studentresult)<span class="operator">&lt;</span></span><br><span class="line">(<span class="keyword">SELECT</span> <span class="built_in">AVG</span>(studentresult) <span class="keyword">FROM</span> <span class="keyword">result</span>);</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查询所有科目中成绩最低的学生信息</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> studentno <span class="keyword">IN</span></span><br><span class="line">(<span class="keyword">SELECT</span> studentno <span class="keyword">FROM</span> <span class="keyword">result</span> <span class="keyword">WHERE</span> studentresult <span class="operator">=</span></span><br><span class="line">(<span class="keyword">SELECT</span> <span class="built_in">MIN</span>(studentresult) <span class="keyword">FROM</span> <span class="keyword">result</span>) );</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查询成绩高于所有科目平均分的学生信息</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> studentno <span class="keyword">IN</span> (</span><br><span class="line"><span class="keyword">SELECT</span> studentno <span class="keyword">FROM</span> <span class="keyword">result</span> a,</span><br><span class="line">	(<span class="keyword">SELECT</span> <span class="built_in">AVG</span>(studentresult) avgscore ,subjectid <span class="keyword">FROM</span> <span class="keyword">result</span> <span class="keyword">GROUP</span> <span class="keyword">BY</span></span><br><span class="line">subjectid)b</span><br><span class="line">	<span class="keyword">WHERE</span> a.`subjectid`<span class="operator">=</span>b.subjectid <span class="keyword">AND</span> a.`studentresult`<span class="operator">&gt;</span>b.avgscore);</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查询成绩比张三的语文成绩还低的学生信息</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> studentno <span class="keyword">IN</span>(</span><br><span class="line"><span class="keyword">SELECT</span> studentno <span class="keyword">FROM</span> <span class="keyword">result</span> <span class="keyword">WHERE</span> studentresult <span class="operator">&lt;</span>(</span><br><span class="line"><span class="keyword">SELECT</span> studentresult <span class="keyword">FROM</span> <span class="keyword">result</span> <span class="keyword">WHERE</span> studentno<span class="operator">=</span></span><br><span class="line">(<span class="keyword">SELECT</span> studentno <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> studentname<span class="operator">=</span><span class="string">&#x27;张三&#x27;</span>)</span><br><span class="line"><span class="keyword">AND</span> subjectid <span class="operator">=</span> (<span class="keyword">SELECT</span> subjectid <span class="keyword">FROM</span> subjects <span class="keyword">WHERE</span> subjectname<span class="operator">=</span><span class="string">&#x27;语文&#x27;</span>);</span><br><span class="line">)</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<h4 id="2-any-some"><a href="#2-any-some" class="headerlink" title="2)any,some"></a>2)any,some</h4><p>ANY和SOME关键字是同义词，表示满足其中任一条件，它们允许创建一个表达式对子查询的返回值列表进行比较，只要满足内层子查询中的任何一个比较条件，就返回一个结果作为外层查询的条件。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">table</span> tbl1 ( num1 <span class="type">INT</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>); <span class="keyword">CREATE</span> <span class="keyword">table</span> tbl2 ( num2 <span class="type">INT</span> <span class="keyword">NOT</span></span><br><span class="line"><span class="keyword">NULL</span>);</span><br></pre></td></tr></table></figure>

<p> 有两个表tb1与tb2,数据如下</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/post/c24675b4/Users\84750\AppData\Roaming\Typora\typora-user-images\image-20220414113631173.png" alt="image-20220414113631173"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/post/c24675b4/Users\84750\AppData\Roaming\Typora\typora-user-images\image-20220414113638228.png" alt="image-20220414113638228"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> num1 <span class="keyword">FROM</span> tb1 <span class="keyword">WHERE</span> num1<span class="operator">&gt;</span> <span class="keyword">ANY</span>(<span class="keyword">SELECT</span> num2 <span class="keyword">FROM</span> tb2);</span><br><span class="line"><span class="comment">-- 或</span></span><br><span class="line"><span class="keyword">SELECT</span> num1 <span class="keyword">FROM</span> tb1 <span class="keyword">WHERE</span> num1<span class="operator">&gt;</span> <span class="keyword">SOME</span>(<span class="keyword">SELECT</span> num2 <span class="keyword">FROM</span> tb2);</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/post/c24675b4/Users\84750\AppData\Roaming\Typora\typora-user-images\image-20220414113646094.png" alt="image-20220414113646094"></p>
<p>ANY关键字接在一个比较操作符的后面，表示若与子查询返回的任何值比较为TRUE，则返回 TRUE。<br>将tbl1中的num1列的值与之进行比较，只要大于num2列的任意一个数即为符合条件的结果。 </p>
<h4 id="3-All"><a href="#3-All" class="headerlink" title="3)All"></a>3)All</h4><p>ALL关键字接在一个比较操作符的后面，表示与子查询返回的所有值比较为TRUE，则返回TRUE。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> num1 <span class="keyword">FROM</span> tb1 <span class="keyword">WHERE</span> num1<span class="operator">&gt;</span> <span class="keyword">ALL</span>(<span class="keyword">SELECT</span> num2 <span class="keyword">FROM</span> tb2);</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/post/c24675b4/Users\84750\AppData\Roaming\Typora\typora-user-images\image-20220414113703426.png" alt="image-20220414113703426"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 找到工资比人事部工资高的信息</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> sal <span class="operator">&gt;</span> <span class="keyword">ALL</span> (<span class="keyword">SELECT</span> sal <span class="keyword">FROM</span> emp <span class="keyword">WHERE</span> emp.deptid<span class="operator">=</span></span><br><span class="line">(<span class="keyword">SELECT</span> deptid <span class="keyword">FROM</span> dept <span class="keyword">WHERE</span> deptname<span class="operator">=</span><span class="string">&#x27;人事部&#x27;</span>)) ;</span><br></pre></td></tr></table></figure>

<h4 id="4-EXISTS"><a href="#4-EXISTS" class="headerlink" title="4)EXISTS"></a>4)EXISTS</h4><p>EXISTS关键字后面的参数是一个任意的子查询，系统对子查询进行运算以判断它是否返回行，如果至少返回一行，那么EXISTS的结果为true，此时外层查询语句将进行查询；如果子查询没有返回任何行，那么EXISTS返<br>回的结果是false，此时外层语句将不进行查询。 </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> tb1 <span class="keyword">WHERE</span> <span class="keyword">EXISTS</span></span><br><span class="line">(<span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> tb2 <span class="keyword">WHERE</span> num2<span class="operator">&gt;</span><span class="number">10</span>) <span class="keyword">AND</span> num1<span class="operator">&gt;</span><span class="number">10</span>;</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/post/c24675b4/Users\84750\AppData\Roaming\Typora\typora-user-images\image-20220414113721969.png" alt="image-20220414113721969"></p>
<p>如果 SELECT * FROM tb2 WHERE num2&gt;10 有返回结果，则执行外部查询，此时会查询tb1表，并且要过来num1的值大于10的。如果将num2大于100的没有结果，则外部查询不执行。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/post/c24675b4/Users\84750\AppData\Roaming\Typora\typora-user-images\image-20220414113734372.png" alt="image-20220414113734372"></p>
<p>NOT EXISTS 与 EXISTS相反</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/post/c24675b4/Users\84750\AppData\Roaming\Typora\typora-user-images\image-20220414113742384.png" alt="image-20220414113742384"></p>
<h4 id="5-UNION"><a href="#5-UNION" class="headerlink" title="5)UNION"></a>5)UNION</h4><p>创建tb1与tb2，并插入数据</p>
<p> <img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/post/c24675b4/Users\84750\AppData\Roaming\Typora\typora-user-images\image-20220414113749342.png" alt="image-20220414113749342"></p>
<p> <img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/post/c24675b4/Users\84750\AppData\Roaming\Typora\typora-user-images\image-20220414113754679.png" alt="image-20220414113754679"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> tb1</span><br><span class="line"><span class="keyword">UNION</span> <span class="keyword">ALL</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> tb2;</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/post/c24675b4/Users\84750\AppData\Roaming\Typora\typora-user-images\image-20220414113804318.png" alt="image-20220414113804318"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> tb1</span><br><span class="line"><span class="keyword">UNION</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> tb2;</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/post/c24675b4/Users\84750\AppData\Roaming\Typora\typora-user-images\image-20220414113811886.png" alt="image-20220414113811886"></p>
<h4 id="6-正则查询"><a href="#6-正则查询" class="headerlink" title="6)正则查询"></a>6)正则查询</h4><p>正则表达式通常被用来检索或替换那些符合某个模式的文本内容，根据 指定的匹配模式匹配文本中符合要求的特殊字符串。例如，从一个文本文件 中提取电话号码，查找一篇文章中重复的单词或者替换用户输入的某些敏感词语等，这些地方都可以使用正则表达式。正则表达式强大而且灵活，可以应用于非常复杂的查询。 <img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/post/c24675b4/Users\84750\AppData\Roaming\Typora\typora-user-images\image-20220414113821605.png" alt="image-20220414113821605"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 以字母a开头</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> employees <span class="keyword">WHERE</span> first_name REGEXP <span class="string">&#x27;^a&#x27;</span>;</span><br><span class="line"><span class="comment">-- $结尾</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> employees <span class="keyword">WHERE</span> first_name REGEXP <span class="string">&#x27;a$&#x27;</span>;</span><br><span class="line"><span class="comment">-- b中间是任意字符c b与c之间得有一个任意字符，</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> employees <span class="keyword">WHERE</span> first_name REGEXP <span class="string">&#x27;b.c&#x27;</span>;</span><br><span class="line"><span class="comment">-- +b必须得出现到n次</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> employees <span class="keyword">WHERE</span> first_name REGEXP <span class="string">&#x27;b+c&#x27;</span>;</span><br><span class="line"><span class="comment">-- * 必须得0到n次</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> employees <span class="keyword">WHERE</span> first_name REGEXP <span class="string">&#x27;b*c&#x27;</span>;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> employees <span class="keyword">WHERE</span> first_name REGEXP <span class="string">&#x27;b&#123;2,&#125;c&#x27;</span>;</span><br><span class="line"><span class="comment">-- &#123;2,5&#125; 2到5次</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> employees <span class="keyword">WHERE</span> first_name REGEXP <span class="string">&#x27;b&#123;2,4&#125;c&#x27;</span>;</span><br></pre></td></tr></table></figure>

<h3 id="练习：-2"><a href="#练习：-2" class="headerlink" title="练习："></a>练习：</h3><p>创建数据表：employee表</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/post/c24675b4/Users\84750\AppData\Roaming\Typora\typora-user-images\image-20220414140203343.png" alt="image-20220414140203343"></p>
<p>创建部门表 dept</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/post/c24675b4/Users\84750\AppData\Roaming\Typora\typora-user-images\image-20220414140212757.png" alt="image-20220414140212757"></p>
<p>输入记录： employee表</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/post/c24675b4/Users\84750\AppData\Roaming\Typora\typora-user-images\image-20220414140222992.png" alt="image-20220414140222992"></p>
<p>部门表中的记录</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/post/c24675b4/Users\84750\AppData\Roaming\Typora\typora-user-images\image-20220414140249160.png" alt="image-20220414140249160"></p>
<p>  查询练习：</p>
<ol>
<li>查询所有记录的e_no、e_name和e_salary字段值</li>
<li>查询dept_no等于10和20的所有记录</li>
<li>查询工资范围在800~2500之间的员工信息</li>
<li>查询部门编号为20的部门中的员工信息</li>
<li>查询每个部门 高工资的员工信息</li>
<li>查询员工BLAKE所在部门和部门所在地</li>
<li>查询所有员工的部门和部门信息</li>
<li>计算每个部门各有多少名员工</li>
<li>计算不同类型职工的总工资数</li>
<li>计算不同部门的平均工资</li>
<li>查询工资低于1500的员工信息</li>
<li>将查询记录先按部门编号由高到低排列，再按员工工资由高到低排列</li>
<li>查询员工姓名以字母‘A’或‘S’开头的员工的信息</li>
<li>查询到目前为止工龄大于等于18年的员工信息</li>
<li>计算所有女员工（‘F’）的年龄</li>
<li>使用LIMIT查询从第3条记录开始到第6条记录的结果</li>
<li>查询销售人员（SALSEMAN）的 低工资</li>
<li>查询名字以字母N或者S结尾的记录</li>
<li>查询在BeiJing工作的员工的姓名和职务</li>
<li>使用左连接方式查询employee和dept表</li>
<li>查询所有2001~2005年入职的员工的信息，查询部门编号为20和30的员工信息并使用UNION合并两个查询结果</li>
<li>使用LIKE查询员工姓名中包含字母a的记录</li>
<li>使用REGEXP查询员工姓名中包含T、C或者M这3个字母中任意1个的记录</li>
</ol>
<h2 id="七、系统函数"><a href="#七、系统函数" class="headerlink" title="七、系统函数"></a>七、系统函数</h2><p>MySQL中的函数包括数学函数、字符串函数、日期和时间函数、条件判断函数、系统信息函数和加密函数等其他函数</p>
<h3 id="7-1-数学函数"><a href="#7-1-数学函数" class="headerlink" title="7.1 数学函数"></a>7.1 数学函数</h3><ol>
<li><p>绝对值函数<strong>ABS(x)<strong>和返回圆周率的函数</strong>PI()</strong> </p>
</li>
<li><p>平方根函数<strong>SQRT(x)<strong>和求余函数</strong>MOD(x,y)</strong> </p>
</li>
<li><p>获取整数的函数<strong>CEIL(x)<strong>、</strong>CEILING(x)<strong>和</strong>FLOOR(x)</strong> </p>
<p>CEIL(x)和CEILING(x)的意义相同，返回不小于x的 小整数值，返回 值转化为一个BIGINT。 </p>
<p>FLOOR(x)返回不大于x的 大整数值，返回值转化为一个BIGINT。 </p>
</li>
<li><p>获取随机数的函数<strong>RAND()<strong>和</strong>RAND(x)</strong> </p>
<p>RAND(x)返回一个随机浮点值v，范围在0到1之间（0 ≤ v ≤ 1.0）。若已指定一个整数参数x，则它被用作种子值，用来产生重复列。 </p>
</li>
<li><p>函数<strong>ROUND(x)<strong>、</strong>ROUND(x,y)<strong>和</strong>TRUNCATE(x,y)</strong></p>
</li>
</ol>
<p>   ROUND(x)返回 接近于参数x的整数，对x值进行四舍五入。 </p>
<p>   ROUND(x,y)返回 接近于参数x的数，其值保留到小数点后面y位，若y为负值，则将保留x值到小数点左边y位。 </p>
<p>   TRUNCATE(x,y)返回被舍去至小数点后y位的数字x。若y的值为0，则结果不带有小数点或不带有小数部分。若y设为负数，则截（归零）x小数点左起第y位开始后面所有低位的值。 </p>
<ol start="6">
<li><p>符号函数<strong>SIGN(x)</strong> </p>
<p>SIGN(x)返回参数的符号，x的值为负、零或正时返回结果依次为-1、0或1。</p>
</li>
<li><p>幂运算函数<strong>POW(x,y)<strong>、</strong>POWER(x,y)<strong>和</strong>EXP(x)</strong> </p>
<p>POW(x,y)或者POWER(x,y)函数返回x的y次乘方的结果值。 EXP(x)返回e的x乘方后的值。</p>
</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> ROUND(<span class="built_in">AVG</span>(empid),<span class="number">1</span>) <span class="keyword">FROM</span> emp;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">TRUNCATE</span>(<span class="built_in">AVG</span>(empid),<span class="number">1</span>) <span class="keyword">FROM</span> emp;</span><br></pre></td></tr></table></figure>

<h3 id="7-2-字符串函数"><a href="#7-2-字符串函数" class="headerlink" title="7.2 字符串函数"></a>7.2 字符串函数</h3><ol>
<li><p>计算字符串字符数的函数和字符串长度的函数 </p>
<p>CHAR_LENGTH(str)返回值为字符串str所包含的字符个数。一个多字节字符算作一个单字符。 </p>
</li>
<li><p>合并字符串函数**CONCAT(s1,s2,…)**、 CONCAT_WS(x,s1,s2,…)</p>
</li>
<li><p>替换字符串的函数<strong>INSERT(s1,x,len,s2)</strong> </p>
</li>
<li><p>字母大小写转换函数 LOWER (str)或者LCASE (str)可以将字符串str中的字母字符全部转换成 小写字母。 UPPER(str)或者UCASE(str可以将字符串str中的字母字符全部转换成大写字母。 </p>
</li>
<li><p>获取指定长度的字符串的函数<strong>LEFT(s,n)<strong>和</strong>RIGHT(s,n)</strong> </p>
</li>
<li><p>填充字符串的函数<strong>LPAD(s1,len,s2)<strong>和</strong>RP</strong> </p>
</li>
<li><p>删除空格的函数<strong>LTRIM(s)、RTRIM(s)<strong>和</strong>TRIM(s)</strong> </p>
</li>
<li><p>重复生成字符串的函数<strong>REPEAT(s,n)</strong> </p>
</li>
<li><p>空格函数**SPACE(n)<strong>和替换函数</strong>REPLACE(s,s1,s2)**SPACE(n)返回一个由n个空格组成的字符串。  </p>
</li>
<li><p>比较字符串大小的函数<strong>STRCMP(s1,s2)</strong> </p>
</li>
<li><p>获取子串的函数<strong>SUBSTRING(s,n,len)<strong>和</strong>MID(s,n,len)</strong> </p>
</li>
<li><p>匹配子串开始位置的函数 </p>
<p>LOCATE(str1,str)、POSITION(str1 IN str)和INSTR(str, str1)3个函数的作 </p>
</li>
<li><p>字符串逆序的函数<strong>REVERSE(s)</strong> </p>
<p>REVERSE(s)将字符串s反转，返回的字符串的顺序和s字符串顺序相 反。</p>
</li>
<li><p>返回指定字符串位置的函数<strong>FIELD(s,s1,s2,…,sn)</strong> </p>
<p>FIELD(s,s1,s2,…,sn)返回字符串s在列表s1,s2,…,sn中第一次出现的位置，在找不到s的情况下，返回值为0。如果s为NULL，则返回值为0，原因 是NULL不能同任何值进行同等比较。 </p>
</li>
<li><p>返回子串位置的函数<strong>FIND_IN_SET(s1,s2)</strong> </p>
<p>FIND_IN_SET(s1,s2)返回字符串s1在字符串列表s2中出现的位置，字符串列表是一个由多个逗号‘,’分开的字符串组成的列表。如果s1不在s2或s2为空字符串，则返回值为0。如果任意一个参数为 NULL，则返回值为NULL。 这个函数在第一个参数包含一个逗号‘,’时将无法正常运行。</p>
</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">CHAR_LENGTH</span>(<span class="string">&#x27;helloworld&#x27;</span>);</span><br><span class="line"><span class="comment">-- 字符串拼接</span></span><br><span class="line"><span class="keyword">SELECT</span> CONCAT(<span class="string">&#x27;hello&#x27;</span>,<span class="string">&#x27;-&#x27;</span>,<span class="string">&#x27;world&#x27;</span>,<span class="string">&#x27;-&#x27;</span>,<span class="string">&#x27;你好&#x27;</span>);</span><br><span class="line"><span class="comment">-- 以*来拼接后面的字符串</span></span><br><span class="line"><span class="keyword">SELECT</span> CONCAT_WS(<span class="string">&#x27;*&#x27;</span>,<span class="string">&#x27;hello&#x27;</span>,<span class="string">&#x27;world&#x27;</span>,<span class="string">&#x27;你好&#x27;</span>);</span><br><span class="line"><span class="comment">-- 查找hello,再后面的字符串列表中的位置 从 1 开始</span></span><br><span class="line"><span class="keyword">SELECT</span> FIELD(<span class="string">&#x27;hello&#x27;</span>,<span class="string">&#x27;你好&#x27;</span>,<span class="string">&#x27;延安&#x27;</span>,<span class="string">&#x27;helloworld&#x27;</span>);</span><br><span class="line"><span class="keyword">SELECT</span> FIND_IN_SET(<span class="string">&#x27;hello&#x27;</span>,<span class="string">&#x27;你好,延安,hello,world&#x27;</span>);</span><br><span class="line"><span class="keyword">SELECT</span> empid,empname,empsex <span class="keyword">FROM</span> emp;</span><br><span class="line"><span class="keyword">SELECT</span> CONCAT_WS(<span class="string">&#x27;-&#x27;</span>,empid,empname,empsex) <span class="keyword">FROM</span> emp;</span><br><span class="line"><span class="keyword">SELECT</span> FORMAT(&quot;256998.855&quot;,<span class="number">1</span>);</span><br><span class="line"><span class="comment">-- 从第6个开始4个长度替换为ab</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">INSERT</span>(<span class="string">&#x27;helloworld&#x27;</span>,<span class="number">6</span>,<span class="number">4</span>,<span class="string">&#x27;ab&#x27;</span>);</span><br><span class="line"><span class="comment">-- 检索world再helloworld中出现的位置</span></span><br><span class="line"><span class="keyword">SELECT</span> LOCATE(<span class="string">&#x27;world&#x27;</span>,<span class="string">&#x27;helloworld&#x27;</span>);</span><br><span class="line"><span class="comment">-- 从左边截取</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">LEFT</span>(<span class="string">&#x27;helloworld&#x27;</span>,<span class="number">8</span>);</span><br><span class="line"><span class="comment">-- 从右边截取</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">RIGHT</span>(<span class="string">&#x27;helloworld&#x27;</span>,<span class="number">8</span>);</span><br><span class="line"><span class="comment">-- 从第6个位置开始截取到最后</span></span><br><span class="line"><span class="keyword">SELECT</span> SUBSTR(<span class="string">&#x27;helloworld&#x27;</span>,<span class="number">6</span>);</span><br><span class="line"><span class="comment">-- 从第6个位置开始截取三个长度</span></span><br><span class="line"><span class="keyword">SELECT</span> SUBSTR(<span class="string">&#x27;helloworld&#x27;</span>,<span class="number">6</span>,<span class="number">3</span>);</span><br></pre></td></tr></table></figure>

<h4 id="练习：-3"><a href="#练习：-3" class="headerlink" title="练习："></a>练习：</h4><p>已知表中保存一下记录 5-602   12-1203    5-1303  12-608 请按照单元和门牌号排序<br>1）	创建表</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> sales(</span><br><span class="line">	sid <span class="type">INT</span> <span class="keyword">PRIMARY</span> KEY AUTO_INCREMENT,</span><br><span class="line">	snum <span class="type">VARCHAR</span>(<span class="number">50</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>2）	插入记录</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> sales <span class="keyword">VALUE</span>(<span class="keyword">NULL</span>,<span class="string">&#x27;5-602&#x27;</span>),(<span class="keyword">NULL</span>,<span class="string">&#x27;12-1203&#x27;</span>),(<span class="keyword">NULL</span>,<span class="string">&#x27;5-1303&#x27;</span>),</span><br><span class="line">(<span class="keyword">NULL</span>,<span class="string">&#x27;12-608&#x27;</span>),(<span class="keyword">NULL</span>,<span class="string">&#x27;15-1602&#x27;</span>),(<span class="keyword">NULL</span>,<span class="string">&#x27;5-802&#x27;</span>),(<span class="keyword">NULL</span>,<span class="string">&#x27;20-1602&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>3） 实现查询的sql</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> LOCATE(<span class="string">&#x27;-&#x27;</span>,snum) <span class="keyword">FROM</span> sales;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">LEFT</span>(snum,LOCATE(<span class="string">&#x27;-&#x27;</span>,snum)<span class="number">-1</span>) <span class="keyword">FROM</span> sales;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">CHAR_LENGTH</span>(snum)<span class="operator">-</span>LOCATE(<span class="string">&#x27;-&#x27;</span>,snum) <span class="keyword">FROM</span> sales;</span><br><span class="line"><span class="keyword">SELECT</span> snum,</span><br><span class="line">	<span class="keyword">LEFT</span>(snum,LOCATE(<span class="string">&#x27;-&#x27;</span>,snum)<span class="number">-1</span>),</span><br><span class="line">	<span class="keyword">RIGHT</span>(snum,<span class="keyword">CHAR_LENGTH</span>(snum)<span class="operator">-</span>LOCATE(<span class="string">&#x27;-&#x27;</span>,snum)) <span class="keyword">FROM</span> sales;</span><br><span class="line"><span class="comment">-- 排序</span></span><br><span class="line"><span class="keyword">SELECT</span> snum <span class="keyword">FROM</span> sales <span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="keyword">CONVERT</span>(<span class="keyword">LEFT</span>(snum,LOCATE(<span class="string">&#x27;-</span></span><br><span class="line"><span class="string">&#x27;</span>,snum)<span class="number">-1</span>),SIGNED),</span><br><span class="line"><span class="keyword">CONVERT</span>(<span class="keyword">RIGHT</span>(snum,<span class="keyword">CHAR_LENGTH</span>(snum)<span class="operator">-</span>LOCATE(<span class="string">&#x27;-&#x27;</span>,snum)) ,SIGNED);</span><br><span class="line"><span class="comment">-- 日期类型</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">CONVERT</span>(<span class="string">&#x27;2000-8-9&#x27;</span>,<span class="type">DATE</span>);</span><br><span class="line"><span class="comment">-- 转为正数signed</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">CONVERT</span>(<span class="string">&#x27;1000&#x27;</span>,SIGNED);</span><br></pre></td></tr></table></figure>

<h3 id="7-3-日期和时间函数"><a href="#7-3-日期和时间函数" class="headerlink" title="7.3 日期和时间函数"></a>7.3 日期和时间函数</h3><p>1.系统当前时间</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> NOW();</span><br><span class="line"><span class="keyword">SELECT</span> SYSDATE();</span><br><span class="line"><span class="keyword">SELECT</span> CURDATE(); <span class="comment">-- 年月日</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">CURRENT_DATE</span>(); <span class="comment">-- 年月日</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">CURRENT_TIME</span>; <span class="comment">-- 时分秒</span></span><br><span class="line"><span class="keyword">SELECT</span> CURTIME(); <span class="comment">-- 时分秒</span></span><br></pre></td></tr></table></figure>

<p>2.addXXX()加上</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- adddate()加上天数</span></span><br><span class="line"><span class="keyword">SELECT</span> ADDDATE(NOW(),<span class="number">40</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> ADDDATE(<span class="string">&#x27;2020-10-19 12:32:45&#x27;</span>,<span class="type">INTERVAL</span> <span class="number">5</span> <span class="keyword">MINUTE</span>); <span class="comment">-- 5 分钟</span></span><br><span class="line"><span class="keyword">SELECT</span> ADDDATE(<span class="string">&#x27;2020-10-19 12:32:45&#x27;</span>,<span class="number">5</span>); <span class="comment">-- 5 天</span></span><br><span class="line"><span class="keyword">SELECT</span> ADDDATE(<span class="string">&#x27;2020-10-19 12:32:45&#x27;</span>,<span class="type">INTERVAL</span> <span class="number">5</span> <span class="keyword">YEAR</span>); <span class="comment">-- 5 年</span></span><br><span class="line"><span class="keyword">SELECT</span> ADDDATE(<span class="string">&#x27;2020-10-19 12:32:45&#x27;</span>,<span class="type">INTERVAL</span> <span class="number">5</span> <span class="keyword">MONTH</span>); <span class="comment">-- 5 个月</span></span><br><span class="line"><span class="comment">-- 加上秒,最大到59</span></span><br><span class="line"><span class="keyword">SELECT</span> ADDTIME(NOW(),<span class="number">59</span>),NOW();</span><br></pre></td></tr></table></figure>

<p>3.DATEDIFF() 两个时间相差天数</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> DATEDIFF(NOW(),<span class="string">&#x27;2020-5-8&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>4.DATE_FORMAT 日期格式化</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> DATE_FORMAT(NOW(),<span class="string">&#x27;%Y年%m月%d日 %H点%i分%s秒&#x27;</span>)</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th><strong>简写</strong></th>
<th><strong>含义</strong></th>
</tr>
</thead>
<tbody><tr>
<td>%a</td>
<td>缩写星期名</td>
</tr>
<tr>
<td>%b</td>
<td>缩写月名</td>
</tr>
<tr>
<td>%c</td>
<td>月，数值</td>
</tr>
<tr>
<td>%D</td>
<td>带有英文前缀的月中的天</td>
</tr>
<tr>
<td>%d</td>
<td>月的天，数值(00-31)</td>
</tr>
<tr>
<td>%e</td>
<td>月的天，数值(0-31)</td>
</tr>
<tr>
<td>%f</td>
<td>微秒</td>
</tr>
<tr>
<td>%H</td>
<td>小时  (00-23)</td>
</tr>
<tr>
<td>%h</td>
<td>小时  (01-12)</td>
</tr>
<tr>
<td>%I</td>
<td>小时  (01-12)</td>
</tr>
<tr>
<td>%i</td>
<td>分钟，数值(00-59)</td>
</tr>
<tr>
<td>%j</td>
<td>年的天  (001-366)</td>
</tr>
<tr>
<td>%k</td>
<td>小时  (0-23)</td>
</tr>
<tr>
<td>%l</td>
<td>小时  (1-12)</td>
</tr>
<tr>
<td>%M</td>
<td>月名</td>
</tr>
<tr>
<td>%m</td>
<td>月，数值(00-12)</td>
</tr>
<tr>
<td>%p</td>
<td>AM  或 PM</td>
</tr>
<tr>
<td>%r</td>
<td>时间，12-小时（hh:mm:ss  AM 或 PM）</td>
</tr>
<tr>
<td>%S</td>
<td>秒(00-59)</td>
</tr>
<tr>
<td>%s</td>
<td>秒(00-59)</td>
</tr>
<tr>
<td>%T</td>
<td>时间,  24-小时 (hh:mm:ss)</td>
</tr>
<tr>
<td>%U</td>
<td>周  (00-53) 星期日是一周的第一天</td>
</tr>
<tr>
<td>%u</td>
<td>周  (00-53) 星期一是一周的第一天</td>
</tr>
<tr>
<td>%V</td>
<td>周  (01-53) 星期日是一周的第一天，与 %X 使用</td>
</tr>
<tr>
<td>%v</td>
<td>周  (01-53) 星期一是一周的第一天，与 %x 使用</td>
</tr>
<tr>
<td>%W</td>
<td>星期名</td>
</tr>
<tr>
<td>%w</td>
<td>周的天 （0&#x3D;星期日,  6&#x3D;星期六）</td>
</tr>
<tr>
<td>%X</td>
<td>年，其中的星期日是周的第一天，4 位，与  %V 使用</td>
</tr>
<tr>
<td>%x</td>
<td>年，其中的星期一是周的第一天，4 位，与  %v 使用</td>
</tr>
<tr>
<td>%Y</td>
<td>年，4 位</td>
</tr>
<tr>
<td>%y</td>
<td>年，2 位</td>
</tr>
</tbody></table>
<ol start="5">
<li><p>DATE_SUB(date,INTERVAL expr type) 减去多少天</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> DATE_SUB(NOW(),<span class="type">INTERVAL</span> <span class="number">45</span> <span class="keyword">DAY</span>);</span><br><span class="line"><span class="keyword">SELECT</span> DATE_SUB(NOW(),<span class="type">INTERVAL</span> <span class="number">3</span> <span class="keyword">YEAR</span>);</span><br><span class="line"><span class="keyword">SELECT</span> DATE_SUB(NOW(),<span class="type">INTERVAL</span> <span class="number">3</span> <span class="keyword">MONTH</span>);</span><br></pre></td></tr></table></figure>
</li>
<li><p>EXTRACT<br>EXTRACT(type FROM date)函数所使用的时间间隔类型说明符与DATE_ADD()或DATE_SUB()的相同，但它从日期中提取一部分，而不是执行日期运算</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">EXTRACT</span>(<span class="keyword">DAY</span> <span class="keyword">FROM</span> NOW()) ;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">EXTRACT</span>(<span class="keyword">YEAR</span> <span class="keyword">FROM</span> NOW()) ;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">EXTRACT</span>(<span class="keyword">MONTH</span> <span class="keyword">FROM</span> NOW()) ;</span><br></pre></td></tr></table></figure>
</li>
<li><p>MONTH(),MONTHNAME() 获取月份函数</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">MONTH</span>(NOW()); <span class="comment">-- 获取月份数字</span></span><br><span class="line"><span class="keyword">SELECT</span> MONTHNAME(NOW()); <span class="comment">-- 获取月份 英文</span></span><br></pre></td></tr></table></figure></li>
</ol>
<ol start="8">
<li><p>   DAYNAME(d)、DAYOFWEEK(d)和WEEKDAY(d)<br>  DAYNAME(d)函数返回d对应的工作日的英文名称，例如Sunday、 Monday等<br>  DAYOFWEEK(d)函数返回d对应的一周中的索引（位置，1表示周日，2表示周一，…，7表示周六）。<br>  WEEKDAY(d)返回d对应的工作日索引：0表示周一，1表示周二，…，6表示周日。</p>
</li>
<li><p>   WEEK(d)和WEEKOFYEAR(d)<br>  WEEK(d)计算日期d是一年中的第几周WEEK()的双参数形式允许指定该星期是否起始于周日或周一，以及返回值的范围是否为0<del>53或1</del>53。 若Mode参数被省略，则使用default_week_format 系统自变量的值.</p>
<p>  WEEKOFYEAR(d)计算某天位于一年中的第几周，范围是1~53，相当于WEEK(d,3)。</p>
</li>
</ol>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/post/c24675b4/Users\84750\AppData\Roaming\Typora\typora-user-images\image-20220417155324333.png" alt="image-20220417155324333"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> WEEK(NOW()),WEEK(NOW(),<span class="number">0</span>),WEEK(NOW(),<span class="number">1</span>),WEEK(NOW(),<span class="number">3</span>);</span><br></pre></td></tr></table></figure>

<p>​	10.DAYOFYEAR(d)和DAYOFMONTH(d)<br>​     	DAYOFYEAR(d)函数返回d是一年中的第几天，范围是1<del>366。<br>​     	DAYOFMONTH(d)函数返回d是一个月中的第几天，范围是1</del>31。<br>​	11.YEAR(),QUARTER(),MINUTE(),SECOND()<br>​     	YEAR(date)返回date对应的年份，范围是1970<del>2069.<br>        QUARTER(date)返回date对应的一年中的季度值，范围是1</del>4。<br>        MINUTE(time)返回time对应的分钟数，范围是0<del>59。<br>        SECOND(time)返回time对应的秒数，范围是0</del>59。</p>
<p>练习：<br>1&gt;  求今天过生日的学生信息<br>2&gt; 本周过生日的学生信息<br>3&gt; 统计本年每个季度的消费总金额</p>
<h3 id="7-4条件判断函数"><a href="#7-4条件判断函数" class="headerlink" title="7.4条件判断函数"></a>7.4条件判断函数</h3><ol>
<li><p>IF(expr,v1,v2)函数<br>IF(expr, v1, v2)：如果表达式expr是TRUE(expr &lt;&gt; 0 and expr &lt;&gt; NULL)，则返回值为v1；否则返回值为v2.IF()的返回值为数字值或字符串值，具体情况视其所在语境而定。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> salary, IF(salary<span class="operator">&gt;</span><span class="number">20000</span>,<span class="string">&#x27;高工资&#x27;</span>,<span class="string">&#x27;低工资&#x27;</span>) <span class="keyword">FROM</span> employees;</span><br></pre></td></tr></table></figure>
</li>
<li><p>IFNULL(v1,v2)函数<br>IFNULL(v1,v2)：假如v1不为NULL，则IFNULL()的返回值为v1；否则其返回值为v2。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> manager_id,IFNULL(manager_id,<span class="string">&#x27;无上级领导&#x27;</span>) <span class="keyword">FROM</span> employees;</span><br></pre></td></tr></table></figure>
</li>
<li><p>CASE函数<br>CASE expr WHEN v1 THEN r1 [WHEN v2 THEN r2]…[ELSE rn+1] END：如果expr值等于某个vn，则返回对应位置THEN后面的结果；如果与所有值都不相等，则返回ELSE后面的rn+1。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> salary,</span><br><span class="line">	<span class="keyword">CASE</span> salary <span class="keyword">WHEN</span> <span class="number">24000</span> <span class="keyword">THEN</span> <span class="string">&#x27;高工资&#x27;</span></span><br><span class="line">				<span class="keyword">WHEN</span> <span class="number">17000</span> <span class="keyword">THEN</span> <span class="string">&#x27;基本工资&#x27;</span></span><br><span class="line">	<span class="keyword">END</span></span><br><span class="line">	</span><br><span class="line">	<span class="keyword">FROM</span> employees;</span><br><span class="line">	<span class="keyword">SELECT</span> job_id,</span><br><span class="line">	<span class="keyword">CASE</span> job_id <span class="keyword">WHEN</span> <span class="string">&#x27;AD_PRES&#x27;</span> <span class="keyword">THEN</span> <span class="string">&#x27;CEO&#x27;</span></span><br><span class="line">				<span class="keyword">WHEN</span> <span class="string">&#x27;AD_VP&#x27;</span> <span class="keyword">THEN</span> <span class="string">&#x27;经理&#x27;</span></span><br><span class="line">				<span class="keyword">WHEN</span> <span class="string">&#x27;IT_PROG&#x27;</span> <span class="keyword">THEN</span> <span class="string">&#x27;IT&#x27;</span></span><br><span class="line">				<span class="keyword">ELSE</span> <span class="string">&#x27;基本工种&#x27;</span></span><br><span class="line">	<span class="keyword">END</span> jobtype</span><br><span class="line">	</span><br><span class="line"><span class="keyword">FROM</span> employees;</span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="7-5系统信息函数"><a href="#7-5系统信息函数" class="headerlink" title="7.5系统信息函数"></a>7.5系统信息函数</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> VERSION(); <span class="comment">-- 版本</span></span><br><span class="line"><span class="keyword">SELECT</span> CONNECTION_ID(); <span class="comment">-- 查看当前用户的链接数</span></span><br><span class="line"><span class="comment">-- 查看链接的详细信息</span></span><br><span class="line"><span class="keyword">SHOW</span> PROCESSLIST; <span class="comment">-- 前100条</span></span><br><span class="line"><span class="keyword">SHOW</span> <span class="keyword">FULL</span> PROCESSLIST; <span class="comment">-- 所有信息</span></span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/post/c24675b4/Users\84750\AppData\Roaming\Typora\typora-user-images\image-20220417155440581.png" alt="image-20220417155440581"></p>
<ol>
<li>   Id列，用户登录MySQL时，系统分配的是“connection id”。 </li>
<li>   User列，显示当前用户。如果不是root，这个命令就只显示用户权限范围内的SQL语句。</li>
<li>   Host列，显示这个语句是从哪个IP的哪个端口上发出的，可以用来追踪出现问题语句的用户。 </li>
<li>   db列，显示这个进程目前连接的是哪个数据库。 </li>
<li>   Command列，显示当前连接执行的命令，一般取值为休眠 （Sleep）、查询（Query）、连接（Connect）。 </li>
<li>   Time列，显示这个状态持续的时间，单位是秒。 </li>
<li>   State列，显示使用当前连接的SQL语句的状态，很重要的列。后续会有所有状态的描述， State只是语句执行中的某一个状态一个SQL语 句，以查询为例，可能需要经过Copying to tmp table、Sorting result、 Sending data等状态才可以完成。 </li>
<li>   Info列，显示这个SQL语句，是判断问题语句的一个重要依据。</li>
</ol>
<h3 id="7-6-获取用户名函数"><a href="#7-6-获取用户名函数" class="headerlink" title="7.6 获取用户名函数"></a>7.6 获取用户名函数</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">USER</span>(),<span class="built_in">CURRENT_USER</span>(),<span class="built_in">SYSTEM_USER</span>(),<span class="built_in">SESSION_USER</span>();</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/post/c24675b4/Users\84750\AppData\Roaming\Typora\typora-user-images\image-20220414141044709.png" alt="image-20220414141044709"></p>
<h3 id="7-7-获取最后一个自动生成的ID的值函数"><a href="#7-7-获取最后一个自动生成的ID的值函数" class="headerlink" title="7.7 获取最后一个自动生成的ID的值函数"></a>7.7 获取最后一个自动生成的ID的值函数</h3><p>LAST_INSERT_ID()函数返回 后生成的AUTO_INCREMENT值。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> LAST_INSERT_ID()</span><br></pre></td></tr></table></figure>

<p>在向数 据表中插入一条新记录时，LAST_INSERT_ID()返回带有 AUTO_INCREMENT约束的字段<br>新生成的值；使用一条INSERT语句插入多行时，LAST_INSERT_ID()只返回插的第一行数据时产生的值之所以这样，是因为这 使依靠其他服务器复制同样的INSERT语句变得简单。 </p>
<h3 id="7-8其他函数"><a href="#7-8其他函数" class="headerlink" title="7.8其他函数"></a>7.8其他函数</h3><p>格式化函数FORMAT(x,n) </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> FORMAT(<span class="number">14722.25862</span>, <span class="number">4</span>),FORMAT(<span class="number">14722.25868</span>, <span class="number">4</span>),FORMAT(<span class="number">14722.25862</span>,<span class="number">0</span>);</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/post/c24675b4/Users\84750\AppData\Roaming\Typora\typora-user-images\image-20220414141112655.png" alt="image-20220414141112655"></p>
<p>  类型转换函数：CAST(x, AS type)和CONVERT(x, type)函数将一个类型的值转换为另一个类型的值，可转换的type有BINARY、CHAR(n)、DATE、TIME、 DATETIME、DECIMAL、SIGNED、UNSIGNED。</p>
<h2 id="八、存储过程与自定义函数"><a href="#八、存储过程与自定义函数" class="headerlink" title="八、存储过程与自定义函数"></a>八、存储过程与自定义函数</h2><p>存储程序可以分为存储过程和函数。在MySQL中，创建存储过程和函数使用的语句分别是CREATE<br>PROCEDURE和CREATE FUNCTION。使用CALL语句来调用存储过程，只能用输出变量返回值。函数可以从语句外调用（引用函数名），也能返回标量值。存储过程也可以调用其他存储过程。</p>
<h3 id="1-gt-存储过程："><a href="#1-gt-存储过程：" class="headerlink" title="1&gt;存储过程："></a>1&gt;存储过程：</h3><p>创建存储过程，需要使用CREATE PROCEDURE命令。语法如下：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> name(param)</span><br><span class="line">	<span class="keyword">BEGIN</span></span><br><span class="line">		body;</span><br><span class="line">	<span class="keyword">END</span>$$</span><br></pre></td></tr></table></figure>

<p>name：代表参数的名字，param:参数。参数有 in|out|inout类型。in:输入参数，out:输出参数， inout:输入输出参数。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查找所有的部门数量</span></span><br><span class="line">DELIMITER $$</span><br><span class="line">	<span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> demo()</span><br><span class="line">	<span class="keyword">BEGIN</span></span><br><span class="line">		<span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="number">1</span>) <span class="keyword">FROM</span> depts;</span><br><span class="line">	<span class="keyword">END</span>$$</span><br><span class="line">DELIMITER ;</span><br><span class="line"><span class="comment">-- 调用过程</span></span><br><span class="line"><span class="keyword">CALL</span> demo();</span><br><span class="line"><span class="comment">-- 删除过程</span></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">PROCEDURE</span> demo;</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 输出类型的参数 参数不能以@开头</span></span><br><span class="line">DELIMITER $$</span><br><span class="line">    <span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> demo2(<span class="keyword">OUT</span> num <span class="type">INT</span>)</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">    	<span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="number">1</span>) <span class="keyword">INTO</span> num <span class="keyword">FROM</span> depts;</span><br><span class="line">    <span class="keyword">END</span>$$</span><br><span class="line">DELIMITER ;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 声明变量 @</span></span><br><span class="line"><span class="keyword">CALL</span> demo2(<span class="variable">@num</span>);</span><br><span class="line"><span class="keyword">SELECT</span> <span class="variable">@num</span>;</span><br></pre></td></tr></table></figure>

<h3 id="小练习："><a href="#小练习：" class="headerlink" title="小练习："></a>小练习：</h3><ol>
<li>根据编号查询名字【传入编号，获取名字】</li>
<li>根据编号查询vip的名字(传入编号，获取名字和性别)</li>
<li>创建过程，根据输入的成绩编号【pk】，获取该学号，科目号以及成绩</li>
<li>根据考试号查找学生的名字，科目名字，以及成绩</li>
</ol>
<h3 id="2-gt-函数："><a href="#2-gt-函数：" class="headerlink" title="2&gt;函数："></a>2&gt;函数：</h3><p>创建存储函数，需要使用CREATE FUNCTION语句，基本语法格式如 下</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">FUNCTION</span> funname(parama) <span class="keyword">RETURNS</span> type</span><br></pre></td></tr></table></figure>

<p>注意，如果是8.0，需要设置可以</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SET</span> <span class="keyword">GLOBAL</span> log_bin_trust_function_creators<span class="operator">=</span><span class="literal">TRUE</span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER $$</span><br><span class="line">    <span class="keyword">CREATE</span> <span class="keyword">FUNCTION</span> fun_01() <span class="keyword">RETURNS</span> <span class="type">INT</span></span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        <span class="keyword">DECLARE</span> _num <span class="type">INT</span>;</span><br><span class="line">        <span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>) <span class="keyword">INTO</span> _num <span class="keyword">FROM</span> grade;</span><br><span class="line">        <span class="keyword">RETURN</span> _num;</span><br><span class="line">    <span class="keyword">END</span>$$</span><br><span class="line">DELIMITER ;</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER $$</span><br><span class="line">    <span class="keyword">CREATE</span> <span class="keyword">FUNCTION</span> fun_02(_sid <span class="type">INT</span>) <span class="keyword">RETURNS</span> <span class="type">VARCHAR</span>(<span class="number">50</span>)</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        <span class="keyword">DECLARE</span> _sno <span class="type">VARCHAR</span>(<span class="number">50</span>);</span><br><span class="line">        <span class="keyword">DECLARE</span> _subid <span class="type">INT</span>;</span><br><span class="line">        <span class="keyword">DECLARE</span> _sco <span class="type">INT</span>;</span><br><span class="line">        <span class="keyword">SELECT</span> s_no,sub_id,student_sco <span class="keyword">INTO</span> _sno,_subid,_sco <span class="keyword">FROM</span> score <span class="keyword">WHERE</span> sco_id<span class="operator">=</span>_sid;</span><br><span class="line">        <span class="keyword">RETURN</span> CONCAT(_sno,<span class="string">&#x27;--&#x27;</span>,_subid,<span class="string">&#x27;--&#x27;</span>,_sco);</span><br><span class="line">    <span class="keyword">END</span>$$</span><br><span class="line">DELIMITER ;</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER $$</span><br><span class="line">    <span class="keyword">CREATE</span> <span class="keyword">FUNCTION</span> fun_03(_sid <span class="type">INT</span>, _sno <span class="type">VARCHAR</span>(<span class="number">50</span>), _subid <span class="type">VARCHAR</span>(<span class="number">50</span>)) <span class="keyword">RETURNS</span> <span class="type">VARCHAR</span>(<span class="number">100</span>)</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">    	<span class="keyword">DECLARE</span> _sco <span class="type">INT</span>;</span><br><span class="line">    	<span class="keyword">SELECT</span> s_no,sub_id,IFNULL(student_sco,<span class="number">0</span>) <span class="keyword">INTO</span> _sno,_subid,_sco <span class="keyword">FROM</span> score <span class="keyword">WHERE</span> sco_id<span class="operator">=</span>_sid;</span><br><span class="line">    	<span class="keyword">RETURN</span> CONCAT(_sno,<span class="string">&#x27;--&#x27;</span>,_subid,<span class="string">&#x27;--&#x27;</span>,_sco);</span><br><span class="line">    <span class="keyword">END</span>$$</span><br><span class="line"> DELIMITER ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> score;</span><br><span class="line"><span class="keyword">SELECT</span> fun_03(<span class="number">8</span>,<span class="variable">@sno</span>,<span class="variable">@subid</span>);</span><br><span class="line"><span class="keyword">SELECT</span> CONCAT(<span class="variable">@sno</span>,<span class="variable">@subid</span>);</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 传入条件 如果1 查询</span></span><br><span class="line">DELIMITER $$</span><br><span class="line">    <span class="keyword">CREATE</span> <span class="keyword">FUNCTION</span> fun_05(_cond <span class="type">INT</span>,_id <span class="type">VARCHAR</span>(<span class="number">20</span>) ) <span class="keyword">RETURNS</span> <span class="type">VARCHAR</span>(<span class="number">100</span>)</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        <span class="keyword">DECLARE</span> _sco <span class="type">VARCHAR</span>(<span class="number">50</span>);</span><br><span class="line">        IF _cond<span class="operator">=</span><span class="number">1</span> <span class="keyword">THEN</span></span><br><span class="line">        	<span class="keyword">SELECT</span> g_name <span class="keyword">INTO</span> _sco <span class="keyword">FROM</span> grade <span class="keyword">WHERE</span> g_id<span class="operator">=</span>_id ;</span><br><span class="line">        ELSEIF _cond<span class="operator">=</span><span class="number">2</span> <span class="keyword">THEN</span></span><br><span class="line">       		<span class="keyword">SELECT</span> s_name <span class="keyword">INTO</span> _sco <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> s_no<span class="operator">=</span>_id;</span><br><span class="line">        <span class="keyword">ELSE</span></span><br><span class="line">        	<span class="keyword">SELECT</span> sub_name <span class="keyword">INTO</span> _sco <span class="keyword">FROM</span> subjects <span class="keyword">WHERE</span> sub_id<span class="operator">=</span>_id;</span><br><span class="line">        <span class="keyword">END</span> IF;</span><br><span class="line">    </span><br><span class="line">    	<span class="keyword">RETURN</span> CONCAT(_cond,<span class="string">&#x27;--&#x27;</span>,_id,<span class="string">&#x27;--&#x27;</span>,_sco);</span><br><span class="line">    <span class="keyword">END</span>$$</span><br><span class="line">DELIMITER ;</span><br></pre></td></tr></table></figure>

<h3 id="小练笔："><a href="#小练笔：" class="headerlink" title="小练笔："></a>小练笔：</h3><ol>
<li><p>使用存储函数|过程  传入学号，获取学生的姓名，总分，平均分</p>
</li>
<li><p>输入，科目名字，学时，以及gradeid ，将该数据插入到数据库</p>
</li>
<li><p>根据传入的科目编号删除科目信息，如果该科目以及被考过试，则不能删除</p>
</li>
</ol>
<h2 id="九、触发器、游标与视图"><a href="#九、触发器、游标与视图" class="headerlink" title="九、触发器、游标与视图"></a>九、触发器、游标与视图</h2><h3 id="1、触发器"><a href="#1、触发器" class="headerlink" title="1、触发器"></a>1、触发器</h3><p>MySQL的触发器和存储过程一样，都是嵌入到MySQL的一段程序。触发器是由事件来触发某个操作，这些事件包括INSERT、UPDATAE和 DELETE语句。如果定义了触发程序，当数据库执行这些语句的时候就会激发触发器执行相应的操作，触发程序是与表有关的命名数据库对象，当表上出现特定事件时，将激活该对象。<br>触发器（trigger）是一个特殊的存储过程，不同的是，执行存储过程要 使用CALL语句来调用，而触发器的执行不需要使用CALL语句来调用，也 不需要手工启动，只要当一个预定义的事件发生的时候，就会被MySQL自 动调用。比如当对fruits表进行操作（INSERT、DELETE或UPDATE）时就会激活它执行。 触发器可以查询其他表，而且可以包含复杂的SQL语句。它们主要用于满足复杂的业务规则或要求。</p>
<p>例如，可以根据客户当前的账户状态控制是否允许插入新订单<br> 触发器：在哪个表触发</p>
<p>行级触发器：影响几条记录就会触发几次</p>
<p>语句级触发器:一条sql语句执行了，就会触发一次 </p>
<p>​		before   after </p>
<p>​		新值：新添加的值教新值</p>
<p>​		旧值：<br>​		update grade set gradename&#x3D;’新班级’ where gradeid&#x3D;1;此时“新班级”为新值，数据库中原有的值为旧值。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">一个表不要添加过多的触发器</span><br><span class="line">oracle支持行级触发器以及语句级触发器</span><br><span class="line">mysql:不支持语句级触发器</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 行级触发</span></span><br><span class="line">DELIMITER $$</span><br><span class="line">    <span class="keyword">CREATE</span> <span class="keyword">TRIGGER</span> tri_01 AFTER <span class="keyword">INSERT</span> <span class="keyword">ON</span> dept <span class="keyword">FOR</span> <span class="keyword">EACH</span> <span class="type">ROW</span></span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">    	<span class="keyword">INSERT</span> <span class="keyword">INTO</span> depts <span class="keyword">VALUES</span>(<span class="keyword">NULL</span>,new.deptid,<span class="string">&#x27;新增&#x27;</span>);</span><br><span class="line">    <span class="keyword">END</span>$$</span><br><span class="line">DELIMITER ;</span><br><span class="line"></span><br><span class="line">DELIMITER $$</span><br><span class="line">    <span class="keyword">CREATE</span> <span class="keyword">TRIGGER</span> tri_02 AFTER <span class="keyword">DELETE</span> <span class="keyword">ON</span> dept <span class="keyword">FOR</span> <span class="keyword">EACH</span> <span class="type">ROW</span></span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">    	<span class="keyword">INSERT</span> <span class="keyword">INTO</span> depts <span class="keyword">VALUES</span>(<span class="keyword">NULL</span>,old.deptid,<span class="string">&#x27;删除&#x27;</span>);</span><br><span class="line">    <span class="keyword">END</span>$$</span><br><span class="line">DELIMITER ;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>会员等级  总的消费金额到底一定的额度，对应的等级信息</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER $$</span><br><span class="line">    <span class="keyword">CREATE</span> <span class="keyword">TRIGGER</span> tri_03 AFTER <span class="keyword">INSERT</span> <span class="keyword">ON</span> sale <span class="keyword">FOR</span> <span class="keyword">EACH</span> <span class="type">ROW</span></span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        <span class="keyword">DECLARE</span> _allmoney <span class="type">INT</span>;</span><br><span class="line">        <span class="keyword">SELECT</span> <span class="built_in">SUM</span>(money) <span class="keyword">INTO</span> _allmoney <span class="keyword">FROM</span> sale <span class="keyword">WHERE</span> vipId<span class="operator">=</span>new.vipId;</span><br><span class="line">        IF _allmoney<span class="operator">&gt;</span><span class="number">5000</span> <span class="keyword">THEN</span></span><br><span class="line">        	<span class="keyword">UPDATE</span> vip <span class="keyword">SET</span> vipLeve<span class="operator">=</span><span class="number">4</span> <span class="keyword">WHERE</span> vipId<span class="operator">=</span>new.vipId;</span><br><span class="line">        ELSEIF _allmoney<span class="operator">&gt;</span><span class="number">1000</span> <span class="keyword">THEN</span></span><br><span class="line">       		<span class="keyword">UPDATE</span> vip <span class="keyword">SET</span> vipLeve<span class="operator">=</span><span class="number">3</span> <span class="keyword">WHERE</span> vipId<span class="operator">=</span>new.vipId;</span><br><span class="line">        ELSEIF _allmoney<span class="operator">&gt;</span><span class="number">100</span> <span class="keyword">THEN</span></span><br><span class="line">        	<span class="keyword">UPDATE</span> vip <span class="keyword">SET</span> vipLeve<span class="operator">=</span><span class="number">2</span> <span class="keyword">WHERE</span> vipId<span class="operator">=</span>new.vipId;</span><br><span class="line">        <span class="keyword">END</span> IF;</span><br><span class="line">    <span class="keyword">END</span>$$</span><br><span class="line">DELIMITER ;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>小练习：</p>
<p>部门表中有个部门人数，如何自动维护部门人数</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER $$</span><br><span class="line">    <span class="keyword">CREATE</span> <span class="keyword">TRIGGER</span> tri_demo2 AFTER <span class="keyword">DELETE</span> <span class="keyword">ON</span> emp <span class="keyword">FOR</span> <span class="keyword">EACH</span> <span class="type">ROW</span></span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">    	<span class="keyword">UPDATE</span> dept <span class="keyword">SET</span> deptnum<span class="operator">=</span>deptnum<span class="number">-1</span> <span class="keyword">WHERE</span> deptid<span class="operator">=</span>old.deptid;</span><br><span class="line">    <span class="keyword">END</span>$$</span><br><span class="line">DELIMITER ;</span><br><span class="line"></span><br><span class="line">DELIMITER $$</span><br><span class="line">    <span class="keyword">CREATE</span> <span class="keyword">TRIGGER</span> tri_demo3 AFTER <span class="keyword">UPDATE</span> <span class="keyword">ON</span> emp <span class="keyword">FOR</span> <span class="keyword">EACH</span> <span class="type">ROW</span></span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        IF old.deptid <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">AND</span> new.deptid <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">THEN</span></span><br><span class="line">        <span class="keyword">UPDATE</span> dept <span class="keyword">SET</span> deptnum<span class="operator">=</span>deptnum<span class="number">-1</span> <span class="keyword">WHERE</span> deptid<span class="operator">=</span>old.deptid;</span><br><span class="line">        <span class="keyword">UPDATE</span> dept <span class="keyword">SET</span> deptnum<span class="operator">=</span>deptnum<span class="operator">+</span><span class="number">1</span> <span class="keyword">WHERE</span> deptid<span class="operator">=</span>new.deptid;</span><br><span class="line">        ELSEIF new.deptid <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">THEN</span></span><br><span class="line">        	<span class="keyword">UPDATE</span> dept <span class="keyword">SET</span> deptnum<span class="operator">=</span>deptnum<span class="operator">+</span><span class="number">1</span> <span class="keyword">WHERE</span> deptid<span class="operator">=</span>new.deptid;</span><br><span class="line">        <span class="keyword">END</span> IF;</span><br><span class="line">    <span class="keyword">END</span>$$</span><br><span class="line">DELIMITER ;</span><br><span class="line"></span><br><span class="line">DELIMITER $$</span><br><span class="line">    <span class="keyword">CREATE</span> <span class="keyword">TRIGGER</span> tri_demo AFTER <span class="keyword">INSERT</span> <span class="keyword">ON</span> emp <span class="keyword">FOR</span> <span class="keyword">EACH</span> <span class="type">ROW</span></span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">    	<span class="keyword">UPDATE</span> dept <span class="keyword">SET</span> deptnum<span class="operator">=</span>deptnum<span class="operator">+</span><span class="number">1</span> <span class="keyword">WHERE</span> deptid<span class="operator">=</span>new.deptid;</span><br><span class="line">    <span class="keyword">END</span>$$</span><br><span class="line">DELIMITER ;</span><br></pre></td></tr></table></figure>

<h3 id="2、流程语句"><a href="#2、流程语句" class="headerlink" title="2、流程语句"></a>2、流程语句</h3><ol>
<li>IF语句</li>
</ol>
   <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER $$</span><br><span class="line">    <span class="keyword">CREATE</span> <span class="keyword">TRIGGER</span> tri_04 AFTER <span class="keyword">INSERT</span> <span class="keyword">ON</span> sale <span class="keyword">FOR</span> <span class="keyword">EACH</span> <span class="type">ROW</span></span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        <span class="keyword">DECLARE</span> _num <span class="type">INT</span>;</span><br><span class="line">        <span class="keyword">SELECT</span> goodsNum <span class="keyword">INTO</span> _num <span class="keyword">FROM</span> goods <span class="keyword">WHERE</span> goodsId<span class="operator">=</span>new.goodsId;</span><br><span class="line"></span><br><span class="line">        IF _num<span class="operator">&gt;</span>new.num <span class="keyword">THEN</span></span><br><span class="line">       		<span class="keyword">UPDATE</span> goods <span class="keyword">SET</span> goodsnum<span class="operator">=</span>goodsnum<span class="operator">-</span>new.num <span class="keyword">WHERE</span> goodsid<span class="operator">=</span>new.goodsId;</span><br><span class="line">        <span class="keyword">END</span> IF;</span><br><span class="line">    <span class="keyword">END</span>$$</span><br><span class="line">DELIMITER ;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ol start="2">
<li><p>循环结构</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER $$</span><br><span class="line">    <span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> pro_01(num <span class="type">INT</span>)</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        <span class="keyword">DECLARE</span> _sum <span class="type">INT</span> <span class="keyword">DEFAULT</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">DECLARE</span> _i <span class="type">INT</span> <span class="keyword">DEFAULT</span> <span class="number">1</span>;</span><br><span class="line">        WHILE _i<span class="operator">&lt;=</span>num DO</span><br><span class="line">            <span class="keyword">SET</span> _sum<span class="operator">=</span>_sum<span class="operator">+</span>_i;</span><br><span class="line">            <span class="keyword">SET</span> _i<span class="operator">=</span>_i<span class="operator">+</span><span class="number">1</span>;</span><br><span class="line">        <span class="keyword">END</span> WHILE;</span><br><span class="line">        <span class="keyword">SELECT</span> _sum;</span><br><span class="line">    <span class="keyword">END</span>$$</span><br><span class="line">DELIMITER ;</span><br><span class="line"></span><br><span class="line">DELIMITER $$</span><br><span class="line">    <span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> pro_02(num <span class="type">INT</span>)</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        <span class="keyword">DECLARE</span> _sum <span class="type">INT</span> <span class="keyword">DEFAULT</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">DECLARE</span> _i <span class="type">INT</span> <span class="keyword">DEFAULT</span> <span class="number">1</span>;</span><br><span class="line">        a:LOOP</span><br><span class="line">        	IF _i<span class="operator">&gt;</span>num <span class="keyword">THEN</span></span><br><span class="line">        		LEAVE a;</span><br><span class="line">        	<span class="keyword">END</span> IF;</span><br><span class="line">        	<span class="keyword">SET</span> _sum<span class="operator">=</span>_sum<span class="operator">+</span>_i;</span><br><span class="line">        	<span class="keyword">SET</span> _i<span class="operator">=</span>_i<span class="operator">+</span><span class="number">1</span>;</span><br><span class="line">        <span class="keyword">END</span> LOOP;</span><br><span class="line">        <span class="keyword">SELECT</span> _sum;</span><br><span class="line">    <span class="keyword">END</span>$$</span><br><span class="line">DELIMITER ;</span><br><span class="line"></span><br><span class="line">DELIMITER $$</span><br><span class="line">    <span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> pro_03(num <span class="type">INT</span>)</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        <span class="keyword">DECLARE</span> _sum <span class="type">INT</span> <span class="keyword">DEFAULT</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">DECLARE</span> _i <span class="type">INT</span> <span class="keyword">DEFAULT</span> <span class="number">1</span>;</span><br><span class="line">        REPEAT</span><br><span class="line">            <span class="keyword">SET</span> _sum<span class="operator">=</span>_sum<span class="operator">+</span>_i;</span><br><span class="line">            <span class="keyword">SET</span> _i<span class="operator">=</span>_i<span class="operator">+</span><span class="number">1</span>;</span><br><span class="line">        UNTIL _i<span class="operator">&gt;</span>num <span class="keyword">END</span> REPEAT;</span><br><span class="line">        <span class="keyword">SELECT</span> _sum;</span><br><span class="line">    <span class="keyword">END</span>$$</span><br><span class="line">DELIMITER ;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="3、游标"><a href="#3、游标" class="headerlink" title="3、游标"></a>3、游标</h3><p>​      游标是处理多行数据的，游标需要开启，抓取，关闭的</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER $$</span><br><span class="line">    <span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> pro_04()</span><br><span class="line">    <span class="keyword">BEGIN</span></span><br><span class="line">        <span class="keyword">DECLARE</span> done <span class="type">INT</span> <span class="keyword">DEFAULT</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">DECLARE</span> _typeid <span class="type">VARCHAR</span>(<span class="number">50</span>);</span><br><span class="line">        <span class="keyword">DECLARE</span> _typename <span class="type">VARCHAR</span>(<span class="number">50</span>);</span><br><span class="line">        <span class="keyword">DECLARE</span> _typedes <span class="type">VARCHAR</span>(<span class="number">50</span>);</span><br><span class="line">        <span class="keyword">DECLARE</span> cur_type <span class="keyword">CURSOR</span> <span class="keyword">FOR</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> producttype;</span><br><span class="line">        <span class="keyword">DECLARE</span> CONTINUE HANDLER <span class="keyword">FOR</span> <span class="keyword">NOT</span> FOUND <span class="keyword">SET</span> done<span class="operator">=</span><span class="number">1</span>;</span><br><span class="line">        <span class="keyword">OPEN</span> cur_type;</span><br><span class="line">            loopname:LOOP</span><br><span class="line">                <span class="keyword">FETCH</span> cur_type <span class="keyword">INTO</span> _typeid,_typename,_typedes;</span><br><span class="line">                IF done<span class="operator">=</span><span class="number">1</span> <span class="keyword">THEN</span></span><br><span class="line">                LEAVE loopname;</span><br><span class="line">                <span class="keyword">END</span> IF;</span><br><span class="line">                <span class="keyword">INSERT</span> type_bak <span class="keyword">VALUES</span>(_typeid,_typename,_typedes);</span><br><span class="line">            <span class="keyword">END</span> LOOP;</span><br><span class="line">        <span class="keyword">CLOSE</span> cur_type;</span><br><span class="line">    <span class="keyword">END</span>$$</span><br><span class="line">DELIMITER ;</span><br></pre></td></tr></table></figure>

<h3 id="4、视图"><a href="#4、视图" class="headerlink" title="4、视图"></a>4、视图</h3><p>​        数据库中的视图是一个虚拟表。同真实的表一样，视图包含一系列带有名称的行和列数据。行和列数据来自由定义视图查询所引用的表，并且在引用视图时动态生成。视图是从一个或者多个表中导出的，视图的行为与表非常相似，但视图是一个虚拟表。在视图中用户可以使用SELECT语句查询数据。</p>
<p>​       视图是一个虚拟表，是从数据库中一个或多个表中导出来的表。视图还可以从已经存在的视图的基础上定义。</p>
<p><strong>视图特点:</strong> </p>
<ol>
<li>简单化：看到的就是需要的。视图不仅可以简化用户对数据的理解，也可以简化它们的操作。那些被经常使用的查询可以被定义为视图，从而使得用户不必为以后的操作每次指定全部的条件                        </li>
<li>安全性：通过视图用户只能查询和修改他们所能见到的数据。数据库中的其他数据则既看不见也取不到。</li>
<li>逻辑数据独立性:视图可帮助用户屏蔽真实表结构变化带来的影响。</li>
</ol>
<p> 视图主要做查看，不做insert,update,delete。虽然单表创建的视图，可以执行，但不推荐。多表创建视图无法执行以上操作。</p>
<p>​        创建视图的语法：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> viewname <span class="keyword">AS</span> <span class="keyword">SELECT</span> ......</span><br></pre></td></tr></table></figure>

<h2 id="十、索引"><a href="#十、索引" class="headerlink" title="十、索引"></a>十、索引</h2><p>索引用于快速找出在某个列中有一特定值的行。不使用索引，MySQL 必须从第1条记录开始读完整个表，直到找出相关的行。表越大，查询数据 所花费的时间越多。如果表中查询的列有一个索引，MySQL 能快速到达某 个位置去搜寻数据文件，而不必查看所有数据。索引是对数据库表中一列或多列的值进行排序的一种结构，使用索引可 提高数据库中特定数据的查询速度</p>
<p>索引的含义和特点：索引是对数据库表中一列或多列的值进行排序的一种结构，使用索引可 提高数据库中特定数据的查询速度。使用索引可以快速找出在某个或多个列中有一特定值的 行，所有MySQL列类型都可以被索引，对相关列使用索引是提高查询操作速度的 佳途径。<br>索引是在存储引擎中实现的，因此，每种存储引擎的索引都不一定完全 相同，并且每种存储引擎也不一定支持所有索引类型。<br>MySQL中 索引的存储类型有两种，即BTREE和HASH，具体和表的存储引擎相关； MyISAM和InnoDB 存储引擎只支持BTREE索引；MEMORY&#x2F;HEAP存储引擎 可以支持HASH和BTREE索引</p>
<p><strong>索引的优点：</strong></p>
<p>（1）通过创建唯一索引，可以保证数据库表中每一行数据的唯一性。 </p>
<p>（ 2）可以大大加快数据的查询速度，这也是创建索引的主要原因。 </p>
<p>（ 3）在实现数据的参考完整性方面，可以加速表和表之间的连接。 </p>
<p>（ 4）在使用分组和排序子句进行数据查询时，也可以显著减少查询中 分组和排序的时间。</p>
<p><strong>索引的缺点：</strong></p>
<p>（1）创建索引和维护索引要耗费时间，并且随着数据量的增加所耗费 的时间也会增加。 </p>
<p>（ 2）索引需要占磁盘空间，除了数据表占数据空间之外，每一个索引 还要占一定的物理空间，如果有大量的索引，索引文件可能比数据文件更快 达到 大文件尺寸。 </p>
<p>（ 3）当对表中的数据进行增加、删除和修改的时候，索引也要动态地 维护，这样就降低了数据的维护速度。</p>
<p>索引的设计原则：索引设计不合理或者缺少索引都会对数据库和应用程序的性能造成障 碍。高效的索引对于获得良好的性能非常重要。</p>
<p><strong>设计索引时，应该考虑以下 准则：</strong></p>
<p>（1）索引并非越多越好，一个表中如有大量的索引，不仅占用磁盘空 间，还会影响INSERT、DELETE、UPDATE等语句的性能，因为在表中的 数据更改时，索引也会进行调整和更新。 </p>
<p>（ 2）避免对经常更新的表进行过多的索引，并且索引中的列要尽可能 少。应该经常用于查询的字段创建索引，但要避免添加不必要的字段。 </p>
<p>（ 3）数据量小的表 好不要使用索引，由于数据较少，查询花费的时 间可能比遍历索引的时间还要短，索引可能不会产生优化效果。 </p>
<p>（ 4）在条件表达式中经常用到的不同值较多的列上建立索引，在不同 值很少的列上不要建立索引。比如在学生表的“性别”字段上只 有“男”与“女”两个不同值，因此就无须建立索引，如果建立索引不但不会提 高查询效率，反而会严重降低数据更新速度。 </p>
<p>（ 5）当唯一性是某种数据本身的特征时，指定唯一索引。使用唯一索 引需能确保定义的列的数据完整性，以提高查询速度。 </p>
<p>（ 6）在频繁进行排序或分组（即进行group by或order by操作）的列上 建立索引，如果待排序的列有多个，可以在这些列上建立组合索引。</p>
<p><strong>索引分类：</strong></p>
<p>​	1．普通索引和唯一索引 普通索引是MySQL中的基本索引类型，允许在定义索引的列中插入重 复值和空值。 唯一索引要求索引列的值必须唯一，但允许有空值。如果是组合索引， 则列值的组合必须唯一。主键索引是一种特殊的唯一索引，不允许有空值。<br>​	2．单列索引和组合索引 单列索引即一个索引只包含单个列，一个表可以有多个单列索引。组合索引是指在表的多个字段组合上创建的索引，只有在查询条件中使 用了这些字段的左边字段时，索引才会被使用。使用组合索引时遵循 左前 缀集合。<br>​	 3．全文索引 全文索引类型为FULLTEXT，在定义索引的列上支持值的全文查找， 允许在这些索引列中插入重复值和空值。全文索引可以在CHAR、 VARCHAR或者TEXT类型的列上创建。MySQL中只有MyISAM存储引擎支 持全文索引。<br>​	 4．空间索引 空间索引是对空间数据类型的字段建立的索引，MySQL中的空间数据 类型有4 种，分别是GEOMETRY、POINT、LINESTRING和POLYGON。 MySQL使用SPATIAL关键字进行扩展，使得能够用创建正规索引类似的语 法创建空间索引。创建空间索引的列，必须将其声明为NOT NULL，空间索 引只能在存储引擎为MyISAM的表中创建。</p>
<p><strong>索引创建：</strong></p>
<p>创建普通索引， 基本的索引类型，没有唯一性之类的限制，其作用只是加快对数据的访问速度。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/post/c24675b4/Users\84750\AppData\Roaming\Typora\typora-user-images\image-20220414141522677.png" alt="image-20220414141522677"></p>
<p>如果表已经存在，创建索引的语法：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Alter</span> <span class="keyword">table</span> tabname <span class="keyword">add</span> [<span class="keyword">unique</span><span class="operator">|</span>fulltext<span class="operator">|</span>spatial] index indexname</span><br><span class="line">(colname[length])</span><br></pre></td></tr></table></figure>

<p>删除索引的语法：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Alter</span> <span class="keyword">table</span> tabname <span class="keyword">drop</span> index indexname</span><br></pre></td></tr></table></figure>

<p>创建组合索引：组合索引是在多个字段上创建一个索引。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> test_db(</span><br><span class="line">    vid <span class="type">INT</span> ,</span><br><span class="line">    vname <span class="type">VARCHAR</span>(<span class="number">50</span>),</span><br><span class="line">    vage <span class="type">INT</span>,</span><br><span class="line">    vinfo <span class="type">VARCHAR</span>(<span class="number">200</span>),</span><br><span class="line">    INDEX mul (vid,vname,vage)</span><br><span class="line">);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>由结果可以看到，vid、vname和vage字段上已经成功建立了一个名为 mul的组合索引。组合索引可起几个索引的作用，但是使用时并不是随便查询哪个字段都可以使用索引，而是遵从“左前缀”：利用索引中 左边的列集来匹配行,这样的列集称为 左前缀。</p>
<p>删除索引：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> tabname <span class="keyword">drop</span> index indexname</span><br></pre></td></tr></table></figure>

<h2 id="十一、事务"><a href="#十一、事务" class="headerlink" title="十一、事务"></a>十一、事务</h2><p>数据库事务( transaction)是访问并可能操作各种数据项的一个数据库操作序列，这些操作要么全部执行, 要么全部不执行，是一个不可分割的工作单位。事务由事务开始与事务结束之间执行的全部数据库操作组成<br>事务是由一组SQL语句 组成的逻辑处理单元，它的ACID特性如下：<br>（1）	原子性（Atomicity）：事务具有原子不可分割的特性，要么一起执行，要么都不执行。<br>（2）	一致性（Consistency）：在事务开始和事务结束时，数据都保持一致状态。<br>（3）	隔离性（Isolation）：在事务开始和结束过程中，事务保持着一定的隔离特性，保证事务不受外部并发数据操作的影响。<br>（4）	持久性（Durability）：事务完成后，数据将会被持久化到数据库中。</p>
<p> <img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/post/c24675b4/Users\84750\AppData\Roaming\Typora\typora-user-images\image-20220414141545779.png" alt="image-20220414141545779"></p>
<p>事务有两状态一个是提交【commit】，一个是回滚【rollback】。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">BEGIN</span> ; <span class="comment">-- 开启事务 提交 commit或 回滚rollback</span></span><br><span class="line"><span class="keyword">UPDATE</span> account <span class="keyword">SET</span> abalance<span class="operator">=</span>abalance<span class="number">-2000</span> <span class="keyword">WHERE</span> aid<span class="operator">=</span><span class="number">1</span>;</span><br><span class="line"><span class="keyword">UPDATE</span> account <span class="keyword">SET</span> abalance<span class="operator">=</span>abalance<span class="operator">+</span><span class="number">2000</span> <span class="keyword">WHERE</span> aid<span class="operator">=</span><span class="number">2</span>;</span><br><span class="line"><span class="keyword">COMMIT</span>;</span><br><span class="line">或</span><br><span class="line"><span class="keyword">ROLLBACK</span>;</span><br></pre></td></tr></table></figure>

<p>还可以设置打点事务，即再保存点之前的会提交，保存点之后的会回滚</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">START</span> TRANSACTION ;</span><br><span class="line"><span class="keyword">UPDATE</span> account <span class="keyword">SET</span> abalance<span class="operator">=</span>abalance<span class="number">-10</span> <span class="keyword">WHERE</span> aid<span class="operator">=</span><span class="number">1</span>;</span><br><span class="line"><span class="keyword">SAVEPOINT</span> A;</span><br><span class="line"><span class="keyword">UPDATE</span> account <span class="keyword">SET</span> abalance<span class="operator">=</span>abalance<span class="number">-1000</span> <span class="keyword">WHERE</span> aid<span class="operator">=</span><span class="number">1</span>;</span><br><span class="line"><span class="keyword">UPDATE</span> account <span class="keyword">SET</span> abalance<span class="operator">=</span>abalance<span class="operator">+</span><span class="number">1000</span> <span class="keyword">WHERE</span> aid<span class="operator">=</span><span class="number">2</span>;</span><br><span class="line"><span class="keyword">ROLLBACK</span> <span class="keyword">TO</span> A;</span><br></pre></td></tr></table></figure>

<p>事务隔离级别：一个事务对数据库修改与并行的另一个事务的隔离程度。<br>两个并发事务同时访问数据库表相同的行时，可能存在以下三个问题：<br>1、幻想读，2、不可重复读取 ，3、脏读<br>为了处理这些问题，SQL标准定义了以下几种事务隔离级别</p>
<table>
<thead>
<tr>
<th></th>
<th><strong>脏读</strong></th>
<th><strong>不可重复读</strong></th>
<th><strong>幻读</strong></th>
</tr>
</thead>
<tbody><tr>
<td>Read  uncommitted</td>
<td>√</td>
<td>√</td>
<td>√</td>
</tr>
<tr>
<td>Read  committed</td>
<td>×</td>
<td>√</td>
<td>√</td>
</tr>
<tr>
<td>Repeatable  read</td>
<td>×</td>
<td>×</td>
<td>√</td>
</tr>
<tr>
<td>Serializable</td>
<td>×</td>
<td>×</td>
<td>×</td>
</tr>
</tbody></table>
<p><strong>脏读</strong>：事务A读取到事务B未提交的数据。<br>           比如账号1的账号金额是5000，此时事务B，将1账号的金额更改为8000，但是还未提交事务，此时事务A,查看1账号的金额，看到8000，然后事务B对操作做了回滚。事务A就读取到脏数据。<br>           如果将事务的隔离级别提高到Read uncommitted，便不会产生以上情况。</p>
<p><strong>不可重复读</strong>：事务A查看1账号的金额是2000，此时想再账号上减2000.但是还没操作的时候，事务B,将数据更改了，并再事务A之前提交了事务。此时事务A再次读取该数据的时候，已经改变了。<br>           事务的隔离级别提高到Read committed时，避免了脏读，但是会造成不可重复度。大多数数据库的默认级别就是ReadCommited.可以将事务的隔离级别提高到Repeatable read。也就是事务A读取了数据，再未提交事务的时候，事务B不能对数据进行修改。</p>
<p><strong>幻读</strong>：事务A查看第一次查看记录的时候为80。此时，事务B对该记录做了更改，事务A再看的时候，发现不是80，事务A就像出现环境一样。将隔离级别提高到Serializable就可以避免幻读。<br>查看mysql的事务隔离级别</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> @<span class="variable">@transaction</span>_isolation; [<span class="keyword">select</span> @<span class="variable">@tx</span>_isolation;]</span><br></pre></td></tr></table></figure>

<p>设置mysql的事务隔离级别</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SET</span> SESSION TRANSACTION ISOLATION LEVEL REPEATABLE READ;</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/post/c24675b4/Users\84750\AppData\Roaming\Typora\typora-user-images\image-20220414141620429.png" alt="image-20220414141620429"></p>
<p>脏读：事务A读取到事务B未提交的数据。脏数据所指的就是未提交的数据           设置事务A与事务B的隔离级别为Read uncommitted；</p>
<table>
<thead>
<tr>
<th><strong>事务</strong>A[事务A读取到的8000就是脏数据]</th>
<th><strong>事务</strong>B</th>
</tr>
</thead>
<tbody><tr>
<td>READ  UNCOMMITTED;</td>
<td>READ  UNCOMMITTED;</td>
</tr>
<tr>
<td>select * from  account ;– 5000</td>
<td>select  * from account;–5000</td>
</tr>
<tr>
<td></td>
<td>begin;</td>
</tr>
<tr>
<td></td>
<td>update  account set balance&#x3D;8000 where accid&#x3D;1;</td>
</tr>
<tr>
<td>select * from  account ;– 8000</td>
<td></td>
</tr>
<tr>
<td></td>
<td>rollback</td>
</tr>
</tbody></table>
<p>操作：事务A和事务B都设置事务的隔离级别为READ UNCOMMITTED;</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/post/c24675b4/Users\84750\AppData\Roaming\Typora\typora-user-images\image-20220414141652308.png" alt="image-20220414141652308"></p>
<p>事务B开启事务，并更新记录为8000，此时并未提交</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/post/c24675b4/Users\84750\AppData\Roaming\Typora\typora-user-images\image-20220414141700526.png" alt="image-20220414141700526"></p>
<p>事务A查看数据，看到了8000的结果。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/post/c24675b4/Users\84750\AppData\Roaming\Typora\typora-user-images\image-20220414141707840.png" alt="image-20220414141707840"></p>
<p>事务B又做了回滚，此时事务A读取到的8000，就属于<br><strong>不可重复读</strong>：一个事务先后读取同一条记录，而事务在两次读取之间该数据被其它事务所修改，则两次读取的数据不同，我们称之为不可重复读。<br>       设置事务A与事务B的隔离级别为Read committed；</p>
<table>
<thead>
<tr>
<th><strong>事务</strong>A</th>
<th><strong>事务</strong>B</th>
</tr>
</thead>
<tbody><tr>
<td>READ  COMMITTED;</td>
<td>READ  COMMITTED;</td>
</tr>
<tr>
<td>select * from  account ;– 5000</td>
<td>select  * from account;–5000</td>
</tr>
<tr>
<td></td>
<td>begin;</td>
</tr>
<tr>
<td></td>
<td>update  account set balance&#x3D;balance+3000 where accid&#x3D;1;</td>
</tr>
<tr>
<td></td>
<td>COMMIT;</td>
</tr>
<tr>
<td>begin;</td>
<td></td>
</tr>
<tr>
<td>update  account set balance&#x3D;balance+3000 where accid&#x3D;1;</td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td>COMMIT;</td>
<td></td>
</tr>
<tr>
<td>select * from  account;– 11000??</td>
<td>select  * from account;– 8000</td>
</tr>
</tbody></table>
<p><strong>幻读</strong>:一个事务按相同的查询条件重新读取以前检索过的数据，却发现其他事务插入了满足其查询条件的新数据，这种现象就称为幻读。</p>
<p> 设置事务A与事务B的隔离级别为REPEATABLE READ；</p>
<h2 id="十二、数据库三范式"><a href="#十二、数据库三范式" class="headerlink" title="十二、数据库三范式"></a>十二、数据库三范式</h2><p>为了建立冗余较小、结构合理的数据库，设计数据库时必须遵循一定的规则。在关系型数据库中这种规则就称为范式。范式是符合某一种设计要求的总结。要想设计一个结构合理的关系型数据库，必须满足一定的范式。<br>在实际开发中 为常见的设计范式有三个：</p>
<h3 id="1．第一范式-确保每列保持原子性"><a href="#1．第一范式-确保每列保持原子性" class="headerlink" title="1．第一范式(确保每列保持原子性)"></a>1．第一范式(确保每列保持原子性)</h3><p>第一范式是 基本的范式。如果数据库表中的所有字段值都是不可分解的原子值，就说明该数据库表满足了第一范式。<br>第一范式的合理遵循需要根据系统的实际需求来定。比如某些数据库系统中需要用到“地址”这个属性，本来直接将“地址”属性设计成一个数据库表的字段就行。但是如果系统经常会访问“地址”属性中的“城市” 部分，那么就非要将“地址”这个属性重新拆分为省份、城市、详细地址等多个部分进行存储，这样在对地址中某一部分操作的时候将非常方便。这样设计才算满足了数据库的第一范式，如下表所示。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/post/c24675b4/Users\84750\AppData\Roaming\Typora\typora-user-images\image-20220414141753638.png" alt="image-20220414141753638"></p>
<h3 id="2-第二范式-确保表中的每列都和主键相关"><a href="#2-第二范式-确保表中的每列都和主键相关" class="headerlink" title="2.第二范式(确保表中的每列都和主键相关)"></a>2.第二范式(确保表中的每列都和主键相关)</h3><p>第二范式在第一范式的基础之上更进一层。第二范式需要确保数据库表中的每一列都和主键相关，而不能只与主键的某一部分相关（主要针对联合主键而言）。也就是说在一个数据库表中，一个表中只能保存一种数据，不可以把多种数据保存在同一张数据库表中。</p>
<p>比如要设计一个订单信息表，因为订单中可能会有多种商品，所以要将订单编号和商品编号作为数据库表的联合主键，如下表所示。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/post/c24675b4/Users\84750\AppData\Roaming\Typora\typora-user-images\image-20220414141802188.png" alt="image-20220414141802188"></p>
<p><em>订单信息表</em><br>这样就产生一个问题：这个表中是以订单编号和商品编号作为联合主键。这样在该表中商品名称、单位、商品价格等信息不与该表的主键相关，而仅仅是与商品编号相关。所以在这里违反了第二范式的设计原则。<br>而如果把这个订单信息表进行拆分，把商品信息分离到另一个表中，把订单项目表也分离到另一个表中，就非常完美了。如下所示。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/post/c24675b4/Users\84750\AppData\Roaming\Typora\typora-user-images\image-20220414141815238.png" alt="image-20220414141815238"></p>
<p>这样设计，在很大程度上减小了数据库的冗余。如果要获取订单的商品信息，使用商品编号到商品信息表中查询即可。</p>
<h3 id="3．第三范式-确保每列都和主键列直接相关-而不是间接相关"><a href="#3．第三范式-确保每列都和主键列直接相关-而不是间接相关" class="headerlink" title="3．第三范式(确保每列都和主键列直接相关,而不是间接相关)"></a>3．第三范式(确保每列都和主键列直接相关,而不是间接相关)</h3><p>第三范式需要确保数据表中的每一列数据都和主键直接相关，而不能间接相关。<br>比如在设计一个订单数据表的时候，可以将客户编号作为一个外键和订单表建立相应的关系。而不可以在订单表中添加关于客户其它信息（比如姓名、所属公司等）的字段。如下面这两个表所示的设计就是一个满足第三范式的数据库表。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/post/c24675b4/Users\84750\AppData\Roaming\Typora\typora-user-images\image-20220414141827548.png" alt="image-20220414141827548"></p>
<p>这样在查询订单信息的时候，就可以使用客户编号来引用客户信息表中的记录，也不必在订单信息表中多次输入客户信息的内容，减小了数据冗余。</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="http://example.com">陈天在睡觉</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://example.com/post/c24675b4.html">http://example.com/post/c24675b4.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://example.com" target="_blank">陈天在睡觉</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="/img/%E5%8D%9A%E5%AE%A23.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/post/2d58191d.html"><img class="prev-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/%E5%8D%9A%E5%AE%A21.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">HCIA</div></div></a></div><div class="next-post pull-right"><a href="/post/38c0576c.html"><img class="next-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/%E5%8D%9A%E5%AE%A22.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">RHCSA</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/%E5%A4%B4%E5%83%8F.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">陈天在睡觉</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">7</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">5</div></a></div><div class="card-info-social-icons is-center"><a class="social-icon" href="https://blog.csdn.net/qq_52059326" target="_blank" title="CSDN"><i class="iconfont icon-csdn"></i></a><a class="social-icon" href="https://space.bilibili.com/14631623" target="_blank" title="b站"><i class="iconfont icon-bilibili-fill"></i></a><a class="social-icon" href="https://github.com/chentianzaishuijiao" target="_blank" title="Github"><i class="fab fa-github"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content"><b><font color="#e66b6d">双</font> <font color="#e66d98">手</font> <font color="#e66cc6">合</font> <font color="#cc6de6">十</font> <font color="#9770e6">成</font> <font color="#6d93e6">为</font> <font color="#6fcde6">自</font> <font color="#72e6b6">己</font> <font color="#72e689">的</font> <font color="#99e670">神</font>, <font color="#cde670">自</font> <font color="#e6df72">己</font> <font color="#e6c073">所</font> <font color="#e6a271">信</font> <font color="#e6796f">念</font> <font color="#e65454">的</font> <font color="#e63333">即</font> <font color="#e62c2c">是</font> <font color="#e60101">信</font> <font color="#e60101">仰</font></b> <p align="center"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img-blog.csdnimg.cn/f7384c88956d4378b72e47548e19c9f8.gif" width="50" alt="mao"></p> <p align="center">微信号：a847503688</p> <p align="center">QQ号：847503688</p></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#MySQL"><span class="toc-number">1.</span> <span class="toc-text">MySQL</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E5%88%9D%E8%AF%86MySQL"><span class="toc-number">1.1.</span> <span class="toc-text">一、初识MySQL</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E7%A1%80"><span class="toc-number">1.1.1.</span> <span class="toc-text">1、数据库基础</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-%E4%BB%80%E4%B9%88%E6%98%AF%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">1.1.2.</span> <span class="toc-text">1.1 什么是数据库</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-%E8%A1%A8"><span class="toc-number">1.1.3.</span> <span class="toc-text">1.2 表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3-%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="toc-number">1.1.4.</span> <span class="toc-text">1.3 数据类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-4-%E6%95%B0%E6%8D%AE%E5%BA%93%E6%8A%80%E6%9C%AF%E6%9E%84%E6%88%90"><span class="toc-number">1.1.5.</span> <span class="toc-text">1.4 数据库技术构成</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-4-1-SQL%E8%AF%AD%E8%A8%80"><span class="toc-number">1.1.5.1.</span> <span class="toc-text">1.4.1 SQL语言</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-4-2-%E6%95%B0%E6%8D%AE%E5%BA%93%E6%8E%A5%E5%8F%A3"><span class="toc-number">1.1.5.2.</span> <span class="toc-text">1.4.2 数据库接口</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E3%80%81MySQL"><span class="toc-number">1.2.</span> <span class="toc-text">二、MySQL</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-%E5%AE%A2%E6%88%B7%E7%AB%AF-x2F-%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%BD%AF%E4%BB%B6"><span class="toc-number">1.2.1.</span> <span class="toc-text">2.1 客户端&#x2F;服务器软件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2MySQL%E7%9A%84%E5%AE%89%E8%A3%85%E4%B8%8E%E9%85%8D%E7%BD%AE"><span class="toc-number">1.2.2.</span> <span class="toc-text">2.2MySQL的安装与配置</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C"><span class="toc-number">1.3.</span> <span class="toc-text">三、数据库基本操作</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-%E5%88%9B%E5%BB%BA%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">1.3.1.</span> <span class="toc-text">3.1 创建数据库</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-%E5%88%A0%E9%99%A4%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">1.3.2.</span> <span class="toc-text">3.2 删除数据库</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-InnoDB%E8%A1%A8"><span class="toc-number">1.3.3.</span> <span class="toc-text">3.3 InnoDB表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9D%A2%E8%AF%95%E9%A2%98%EF%BC%9A"><span class="toc-number">1.3.4.</span> <span class="toc-text">面试题：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%83%E4%B9%A0%EF%BC%9A"><span class="toc-number">1.3.5.</span> <span class="toc-text">练习：</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B%E3%80%81%E6%95%B0%E6%8D%AE%E8%A1%A8%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C"><span class="toc-number">1.4.</span> <span class="toc-text">四、数据表的基本操作</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-%E5%88%9B%E5%BB%BA%E6%95%B0%E6%8D%AE%E8%A1%A8"><span class="toc-number">1.4.1.</span> <span class="toc-text">4.1 创建数据表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-%E8%A1%A8%E7%BA%A6%E6%9D%9F"><span class="toc-number">1.4.2.</span> <span class="toc-text">4.2 表约束</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-2-1-%E4%B8%BB%E9%94%AE%E7%BA%A6%E6%9D%9F"><span class="toc-number">1.4.2.1.</span> <span class="toc-text">4.2.1 主键约束</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-%E5%8D%95%E5%AD%90%E6%AE%B5%E4%B8%BB%E9%94%AE"><span class="toc-number">1.4.2.1.1.</span> <span class="toc-text">1.单子段主键</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-%E8%81%94%E5%90%88%E4%B8%BB%E9%94%AE"><span class="toc-number">1.4.2.1.2.</span> <span class="toc-text">2.联合主键</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-2-2-%E9%9D%9E%E7%A9%BA%E7%BA%A6%E6%9D%9F"><span class="toc-number">1.4.2.2.</span> <span class="toc-text">4.2.2 非空约束</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-2-3-%E5%94%AF%E4%B8%80%E7%BA%A6%E6%9D%9F"><span class="toc-number">1.4.2.3.</span> <span class="toc-text">4.2.3 唯一约束</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-2-4-%E9%BB%98%E8%AE%A4%E5%80%BC%E7%BA%A6%E6%9D%9F"><span class="toc-number">1.4.2.4.</span> <span class="toc-text">4.2.4 默认值约束</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-2-5-%E5%A4%96%E9%94%AE%E7%BA%A6%E6%9D%9F"><span class="toc-number">1.4.2.5.</span> <span class="toc-text">4.2.5 外键约束</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-2-6-%E6%9F%A5%E7%9C%8B%E8%A1%A8%E7%BB%93%E6%9E%84"><span class="toc-number">1.4.2.6.</span> <span class="toc-text">4.2.6 查看表结构</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-2-7-%E4%BF%AE%E6%94%B9%E8%A1%A8%E7%BB%93%E6%9E%84"><span class="toc-number">1.4.2.7.</span> <span class="toc-text">4.2.7 修改表结构</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%83%E4%B9%A0%EF%BC%9A-1"><span class="toc-number">1.4.3.</span> <span class="toc-text">练习：</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%94%E3%80%81%E6%95%B0%E6%8D%AECRUD%E6%93%8D%E4%BD%9C"><span class="toc-number">1.5.</span> <span class="toc-text">五、数据CRUD操作</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81%E6%8F%92%E5%85%A5%E6%95%B0%E6%8D%AE"><span class="toc-number">1.5.1.</span> <span class="toc-text">1、插入数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E3%80%81%E6%9B%B4%E6%96%B0%E6%95%B0%E6%8D%AE"><span class="toc-number">1.5.2.</span> <span class="toc-text">2、更新数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%E3%80%81%E5%88%A0%E9%99%A4%E6%95%B0%E6%8D%AE"><span class="toc-number">1.5.3.</span> <span class="toc-text">3、删除数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4%E3%80%81%E6%9F%A5%E8%AF%A2%E6%95%B0%E6%8D%AE"><span class="toc-number">1.5.4.</span> <span class="toc-text">4、查询数据</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8D%95%E8%A1%A8%E6%9F%A5%E8%AF%A2%EF%BC%9A"><span class="toc-number">1.5.4.1.</span> <span class="toc-text">单表查询：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%83%E4%B9%A0%EF%BC%9A%E6%95%B0%E6%8D%AE%E4%BF%AE%E6%94%B9%E4%B8%8E%E5%88%A0%E9%99%A4"><span class="toc-number">1.5.5.</span> <span class="toc-text">练习：数据修改与删除</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AD%E3%80%81%E8%BF%9E%E6%8E%A5%E6%9F%A5%E8%AF%A2%E5%92%8C%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.6.</span> <span class="toc-text">六、连接查询和子查询</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#6-1-%E9%93%BE%E6%8E%A5%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.6.1.</span> <span class="toc-text">6.1 链接查询</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E5%86%85%E8%BF%9E%E6%8E%A5%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.6.1.1.</span> <span class="toc-text">1.内连接查询</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E5%A4%96%E8%BF%9E%E6%8E%A5%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.6.1.2.</span> <span class="toc-text">2.外连接查询</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-2-%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.6.2.</span> <span class="toc-text">6.2 子查询</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.6.2.1.</span> <span class="toc-text">1)子查询</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-any-some"><span class="toc-number">1.6.2.2.</span> <span class="toc-text">2)any,some</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-All"><span class="toc-number">1.6.2.3.</span> <span class="toc-text">3)All</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-EXISTS"><span class="toc-number">1.6.2.4.</span> <span class="toc-text">4)EXISTS</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-UNION"><span class="toc-number">1.6.2.5.</span> <span class="toc-text">5)UNION</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-%E6%AD%A3%E5%88%99%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.6.2.6.</span> <span class="toc-text">6)正则查询</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%83%E4%B9%A0%EF%BC%9A-2"><span class="toc-number">1.6.3.</span> <span class="toc-text">练习：</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%83%E3%80%81%E7%B3%BB%E7%BB%9F%E5%87%BD%E6%95%B0"><span class="toc-number">1.7.</span> <span class="toc-text">七、系统函数</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#7-1-%E6%95%B0%E5%AD%A6%E5%87%BD%E6%95%B0"><span class="toc-number">1.7.1.</span> <span class="toc-text">7.1 数学函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-2-%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%87%BD%E6%95%B0"><span class="toc-number">1.7.2.</span> <span class="toc-text">7.2 字符串函数</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BB%83%E4%B9%A0%EF%BC%9A-3"><span class="toc-number">1.7.2.1.</span> <span class="toc-text">练习：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-3-%E6%97%A5%E6%9C%9F%E5%92%8C%E6%97%B6%E9%97%B4%E5%87%BD%E6%95%B0"><span class="toc-number">1.7.3.</span> <span class="toc-text">7.3 日期和时间函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-4%E6%9D%A1%E4%BB%B6%E5%88%A4%E6%96%AD%E5%87%BD%E6%95%B0"><span class="toc-number">1.7.4.</span> <span class="toc-text">7.4条件判断函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-5%E7%B3%BB%E7%BB%9F%E4%BF%A1%E6%81%AF%E5%87%BD%E6%95%B0"><span class="toc-number">1.7.5.</span> <span class="toc-text">7.5系统信息函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-6-%E8%8E%B7%E5%8F%96%E7%94%A8%E6%88%B7%E5%90%8D%E5%87%BD%E6%95%B0"><span class="toc-number">1.7.6.</span> <span class="toc-text">7.6 获取用户名函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-7-%E8%8E%B7%E5%8F%96%E6%9C%80%E5%90%8E%E4%B8%80%E4%B8%AA%E8%87%AA%E5%8A%A8%E7%94%9F%E6%88%90%E7%9A%84ID%E7%9A%84%E5%80%BC%E5%87%BD%E6%95%B0"><span class="toc-number">1.7.7.</span> <span class="toc-text">7.7 获取最后一个自动生成的ID的值函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-8%E5%85%B6%E4%BB%96%E5%87%BD%E6%95%B0"><span class="toc-number">1.7.8.</span> <span class="toc-text">7.8其他函数</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AB%E3%80%81%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E4%B8%8E%E8%87%AA%E5%AE%9A%E4%B9%89%E5%87%BD%E6%95%B0"><span class="toc-number">1.8.</span> <span class="toc-text">八、存储过程与自定义函数</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-gt-%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%EF%BC%9A"><span class="toc-number">1.8.1.</span> <span class="toc-text">1&gt;存储过程：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%8F%E7%BB%83%E4%B9%A0%EF%BC%9A"><span class="toc-number">1.8.2.</span> <span class="toc-text">小练习：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-gt-%E5%87%BD%E6%95%B0%EF%BC%9A"><span class="toc-number">1.8.3.</span> <span class="toc-text">2&gt;函数：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%8F%E7%BB%83%E7%AC%94%EF%BC%9A"><span class="toc-number">1.8.4.</span> <span class="toc-text">小练笔：</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B9%9D%E3%80%81%E8%A7%A6%E5%8F%91%E5%99%A8%E3%80%81%E6%B8%B8%E6%A0%87%E4%B8%8E%E8%A7%86%E5%9B%BE"><span class="toc-number">1.9.</span> <span class="toc-text">九、触发器、游标与视图</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81%E8%A7%A6%E5%8F%91%E5%99%A8"><span class="toc-number">1.9.1.</span> <span class="toc-text">1、触发器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E3%80%81%E6%B5%81%E7%A8%8B%E8%AF%AD%E5%8F%A5"><span class="toc-number">1.9.2.</span> <span class="toc-text">2、流程语句</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%E3%80%81%E6%B8%B8%E6%A0%87"><span class="toc-number">1.9.3.</span> <span class="toc-text">3、游标</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4%E3%80%81%E8%A7%86%E5%9B%BE"><span class="toc-number">1.9.4.</span> <span class="toc-text">4、视图</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%81%E3%80%81%E7%B4%A2%E5%BC%95"><span class="toc-number">1.10.</span> <span class="toc-text">十、索引</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%81%E4%B8%80%E3%80%81%E4%BA%8B%E5%8A%A1"><span class="toc-number">1.11.</span> <span class="toc-text">十一、事务</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%81%E4%BA%8C%E3%80%81%E6%95%B0%E6%8D%AE%E5%BA%93%E4%B8%89%E8%8C%83%E5%BC%8F"><span class="toc-number">1.12.</span> <span class="toc-text">十二、数据库三范式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%EF%BC%8E%E7%AC%AC%E4%B8%80%E8%8C%83%E5%BC%8F-%E7%A1%AE%E4%BF%9D%E6%AF%8F%E5%88%97%E4%BF%9D%E6%8C%81%E5%8E%9F%E5%AD%90%E6%80%A7"><span class="toc-number">1.12.1.</span> <span class="toc-text">1．第一范式(确保每列保持原子性)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E7%AC%AC%E4%BA%8C%E8%8C%83%E5%BC%8F-%E7%A1%AE%E4%BF%9D%E8%A1%A8%E4%B8%AD%E7%9A%84%E6%AF%8F%E5%88%97%E9%83%BD%E5%92%8C%E4%B8%BB%E9%94%AE%E7%9B%B8%E5%85%B3"><span class="toc-number">1.12.2.</span> <span class="toc-text">2.第二范式(确保表中的每列都和主键相关)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%EF%BC%8E%E7%AC%AC%E4%B8%89%E8%8C%83%E5%BC%8F-%E7%A1%AE%E4%BF%9D%E6%AF%8F%E5%88%97%E9%83%BD%E5%92%8C%E4%B8%BB%E9%94%AE%E5%88%97%E7%9B%B4%E6%8E%A5%E7%9B%B8%E5%85%B3-%E8%80%8C%E4%B8%8D%E6%98%AF%E9%97%B4%E6%8E%A5%E7%9B%B8%E5%85%B3"><span class="toc-number">1.12.3.</span> <span class="toc-text">3．第三范式(确保每列都和主键列直接相关,而不是间接相关)</span></a></li></ol></li></ol></li></ol></div></div></div></div></main><footer id="footer" style="background-image: url('/img/%E5%8D%9A%E5%AE%A23.jpg')"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2023 By 陈天在睡觉</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><script src="/js/search/local-search.js"></script><div class="js-pjax"></div><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/fireworks.min.js"></script><script defer="defer" id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="false" data-click="true"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>